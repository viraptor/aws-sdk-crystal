require "json"
require "time"

module AwsSdk
  module AccessAnalyzer
    module Types

      # Contains information about actions and resources that define permissions to check against a policy.
      struct Access
        include JSON::Serializable

        # A list of actions for the access permissions. Any strings that can be used as an action in an IAM
        # policy can be used in the list of actions to check.
        @[JSON::Field(key: "actions")]
        getter actions : Array(String)?

        # A list of resources for the access permissions. Any strings that can be used as an Amazon Resource
        # Name (ARN) in an IAM policy can be used in the list of resources to check. You can only use a
        # wildcard in the portion of the ARN that specifies the resource ID.
        @[JSON::Field(key: "resources")]
        getter resources : Array(String)?

        def initialize(
          @actions : Array(String)? = nil,
          @resources : Array(String)? = nil
        )
        end
      end

      # You do not have sufficient access to perform this action.
      struct AccessDeniedException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        def initialize(
          @message : String
        )
        end
      end

      # Contains information about an access preview.
      struct AccessPreview
        include JSON::Serializable

        # The ARN of the analyzer used to generate the access preview.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # A map of resource ARNs for the proposed resource configuration.
        @[JSON::Field(key: "configurations")]
        getter configurations : Hash(String, Types::Configuration)

        # The time at which the access preview was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The unique ID for the access preview.
        @[JSON::Field(key: "id")]
        getter id : String

        # The status of the access preview. Creating - The access preview creation is in progress. Completed -
        # The access preview is complete. You can preview findings for external access to the resource. Failed
        # - The access preview creation has failed.
        @[JSON::Field(key: "status")]
        getter status : String

        # Provides more details about the current status of the access preview. For example, if the creation
        # of the access preview fails, a Failed status is returned. This failure can be due to an internal
        # issue with the analysis or due to an invalid resource configuration.
        @[JSON::Field(key: "statusReason")]
        getter status_reason : Types::AccessPreviewStatusReason?

        def initialize(
          @analyzer_arn : String,
          @configurations : Hash(String, Types::Configuration),
          @created_at : Time,
          @id : String,
          @status : String,
          @status_reason : Types::AccessPreviewStatusReason? = nil
        )
        end
      end

      # An access preview finding generated by the access preview.
      struct AccessPreviewFinding
        include JSON::Serializable

        # Provides context on how the access preview finding compares to existing access identified in IAM
        # Access Analyzer. New - The finding is for newly-introduced access. Unchanged - The preview finding
        # is an existing finding that would remain unchanged. Changed - The preview finding is an existing
        # finding with a change in status. For example, a Changed finding with preview status Resolved and
        # existing status Active indicates the existing Active finding would become Resolved as a result of
        # the proposed permissions change.
        @[JSON::Field(key: "changeType")]
        getter change_type : String

        # The time at which the access preview finding was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The ID of the access preview finding. This ID uniquely identifies the element in the list of access
        # preview findings and is not related to the finding ID in Access Analyzer.
        @[JSON::Field(key: "id")]
        getter id : String

        # The Amazon Web Services account ID that owns the resource. For most Amazon Web Services resources,
        # the owning account is the account in which the resource was created.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of the resource that can be accessed in the finding.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        # The preview status of the finding. This is what the status of the finding would be after permissions
        # deployment. For example, a Changed finding with preview status Resolved and existing status Active
        # indicates the existing Active finding would become Resolved as a result of the proposed permissions
        # change.
        @[JSON::Field(key: "status")]
        getter status : String

        # The action in the analyzed policy statement that an external principal has permission to perform.
        @[JSON::Field(key: "action")]
        getter action : Array(String)?

        # The condition in the analyzed policy statement that resulted in a finding.
        @[JSON::Field(key: "condition")]
        getter condition : Hash(String, String)?

        # An error.
        @[JSON::Field(key: "error")]
        getter error : String?

        # The existing ID of the finding in IAM Access Analyzer, provided only for existing findings.
        @[JSON::Field(key: "existingFindingId")]
        getter existing_finding_id : String?

        # The existing status of the finding, provided only for existing findings.
        @[JSON::Field(key: "existingFindingStatus")]
        getter existing_finding_status : String?

        # Indicates whether the policy that generated the finding allows public access to the resource.
        @[JSON::Field(key: "isPublic")]
        getter is_public : Bool?

        # The external principal that has access to a resource within the zone of trust.
        @[JSON::Field(key: "principal")]
        getter principal : Hash(String, String)?

        # The resource that an external principal has access to. This is the resource associated with the
        # access preview.
        @[JSON::Field(key: "resource")]
        getter resource : String?

        # The type of restriction applied to the finding by the resource owner with an Organizations resource
        # control policy (RCP).
        @[JSON::Field(key: "resourceControlPolicyRestriction")]
        getter resource_control_policy_restriction : String?

        # The sources of the finding. This indicates how the access that generated the finding is granted. It
        # is populated for Amazon S3 bucket findings.
        @[JSON::Field(key: "sources")]
        getter sources : Array(Types::FindingSource)?

        def initialize(
          @change_type : String,
          @created_at : Time,
          @id : String,
          @resource_owner_account : String,
          @resource_type : String,
          @status : String,
          @action : Array(String)? = nil,
          @condition : Hash(String, String)? = nil,
          @error : String? = nil,
          @existing_finding_id : String? = nil,
          @existing_finding_status : String? = nil,
          @is_public : Bool? = nil,
          @principal : Hash(String, String)? = nil,
          @resource : String? = nil,
          @resource_control_policy_restriction : String? = nil,
          @sources : Array(Types::FindingSource)? = nil
        )
        end
      end

      # Provides more details about the current status of the access preview. For example, if the creation
      # of the access preview fails, a Failed status is returned. This failure can be due to an internal
      # issue with the analysis or due to an invalid proposed resource configuration.
      struct AccessPreviewStatusReason
        include JSON::Serializable

        # The reason code for the current status of the access preview.
        @[JSON::Field(key: "code")]
        getter code : String

        def initialize(
          @code : String
        )
        end
      end

      # Contains a summary of information about an access preview.
      struct AccessPreviewSummary
        include JSON::Serializable

        # The ARN of the analyzer used to generate the access preview.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The time at which the access preview was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The unique ID for the access preview.
        @[JSON::Field(key: "id")]
        getter id : String

        # The status of the access preview. Creating - The access preview creation is in progress. Completed -
        # The access preview is complete and previews the findings for external access to the resource. Failed
        # - The access preview creation has failed.
        @[JSON::Field(key: "status")]
        getter status : String

        @[JSON::Field(key: "statusReason")]
        getter status_reason : Types::AccessPreviewStatusReason?

        def initialize(
          @analyzer_arn : String,
          @created_at : Time,
          @id : String,
          @status : String,
          @status_reason : Types::AccessPreviewStatusReason? = nil
        )
        end
      end

      # You specify each grantee as a type-value pair using one of these types. You can specify only one
      # type of grantee. For more information, see PutBucketAcl .
      struct AclGrantee
        include JSON::Serializable

        # The value specified is the canonical user ID of an Amazon Web Services account.
        @[JSON::Field(key: "id")]
        getter id : String?

        # Used for granting permissions to a predefined group.
        @[JSON::Field(key: "uri")]
        getter uri : String?

        def initialize(
          @id : String? = nil,
          @uri : String? = nil
        )
        end
      end

      # Contains information about analysis rules for the analyzer. Analysis rules determine which entities
      # will generate findings based on the criteria you define when you create the rule.
      struct AnalysisRule
        include JSON::Serializable

        # A list of rules for the analyzer containing criteria to exclude from analysis. Entities that meet
        # the rule criteria will not generate findings.
        @[JSON::Field(key: "exclusions")]
        getter exclusions : Array(Types::AnalysisRuleCriteria)?

        def initialize(
          @exclusions : Array(Types::AnalysisRuleCriteria)? = nil
        )
        end
      end

      # The criteria for an analysis rule for an analyzer. The criteria determine which entities will
      # generate findings.
      struct AnalysisRuleCriteria
        include JSON::Serializable

        # A list of Amazon Web Services account IDs to apply to the analysis rule criteria. The accounts
        # cannot include the organization analyzer owner account. Account IDs can only be applied to the
        # analysis rule criteria for organization-level analyzers. The list cannot include more than 2,000
        # account IDs.
        @[JSON::Field(key: "accountIds")]
        getter account_ids : Array(String)?

        # An array of key-value pairs to match for your resources. You can use the set of Unicode letters,
        # digits, whitespace, _ , . , / , = , + , and - . For the tag key, you can specify a value that is 1
        # to 128 characters in length and cannot be prefixed with aws: . For the tag value, you can specify a
        # value that is 0 to 256 characters in length. If the specified tag value is 0 characters, the rule is
        # applied to all principals with the specified tag key.
        @[JSON::Field(key: "resourceTags")]
        getter resource_tags : Array(Hash(String, String))?

        def initialize(
          @account_ids : Array(String)? = nil,
          @resource_tags : Array(Hash(String, String))? = nil
        )
        end
      end

      # Contains details about the analyzed resource.
      struct AnalyzedResource
        include JSON::Serializable

        # The time at which the resource was analyzed.
        @[JSON::Field(key: "analyzedAt")]
        getter analyzed_at : Time

        # The time at which the finding was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # Indicates whether the policy that generated the finding grants public access to the resource.
        @[JSON::Field(key: "isPublic")]
        getter is_public : Bool

        # The ARN of the resource that was analyzed.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        # The Amazon Web Services account ID that owns the resource.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of the resource that was analyzed.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        # The time at which the finding was updated.
        @[JSON::Field(key: "updatedAt")]
        getter updated_at : Time

        # The actions that an external principal is granted permission to use by the policy that generated the
        # finding.
        @[JSON::Field(key: "actions")]
        getter actions : Array(String)?

        # An error message.
        @[JSON::Field(key: "error")]
        getter error : String?

        # Indicates how the access that generated the finding is granted. This is populated for Amazon S3
        # bucket findings.
        @[JSON::Field(key: "sharedVia")]
        getter shared_via : Array(String)?

        # The current status of the finding generated from the analyzed resource.
        @[JSON::Field(key: "status")]
        getter status : String?

        def initialize(
          @analyzed_at : Time,
          @created_at : Time,
          @is_public : Bool,
          @resource_arn : String,
          @resource_owner_account : String,
          @resource_type : String,
          @updated_at : Time,
          @actions : Array(String)? = nil,
          @error : String? = nil,
          @shared_via : Array(String)? = nil,
          @status : String? = nil
        )
        end
      end

      # Contains the ARN of the analyzed resource.
      struct AnalyzedResourceSummary
        include JSON::Serializable

        # The ARN of the analyzed resource.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        # The Amazon Web Services account ID that owns the resource.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of resource that was analyzed.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        def initialize(
          @resource_arn : String,
          @resource_owner_account : String,
          @resource_type : String
        )
        end
      end

      # Contains information about the configuration of an analyzer for an Amazon Web Services organization
      # or account.
      struct AnalyzerConfiguration
        include JSON::Serializable

        # Specifies the configuration of an internal access analyzer for an Amazon Web Services organization
        # or account. This configuration determines how the analyzer evaluates access within your Amazon Web
        # Services environment.
        @[JSON::Field(key: "internalAccess")]
        getter internal_access : Types::InternalAccessConfiguration?

        # Specifies the configuration of an unused access analyzer for an Amazon Web Services organization or
        # account.
        @[JSON::Field(key: "unusedAccess")]
        getter unused_access : Types::UnusedAccessConfiguration?

        def initialize(
          @internal_access : Types::InternalAccessConfiguration? = nil,
          @unused_access : Types::UnusedAccessConfiguration? = nil
        )
        end
      end

      # Contains information about the analyzer.
      struct AnalyzerSummary
        include JSON::Serializable

        # The ARN of the analyzer.
        @[JSON::Field(key: "arn")]
        getter arn : String

        # A timestamp for the time at which the analyzer was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The name of the analyzer.
        @[JSON::Field(key: "name")]
        getter name : String

        # The status of the analyzer. An Active analyzer successfully monitors supported resources and
        # generates new findings. The analyzer is Disabled when a user action, such as removing trusted access
        # for Identity and Access Management Access Analyzer from Organizations, causes the analyzer to stop
        # generating new findings. The status is Creating when the analyzer creation is in progress and Failed
        # when the analyzer creation has failed.
        @[JSON::Field(key: "status")]
        getter status : String

        # The type represents the zone of trust or scope for the analyzer.
        @[JSON::Field(key: "type")]
        getter type : String

        # Specifies if the analyzer is an external access, unused access, or internal access analyzer. The
        # GetAnalyzer action includes this property in its response if a configuration is specified, while the
        # ListAnalyzers action omits it.
        @[JSON::Field(key: "configuration")]
        getter configuration : Types::AnalyzerConfiguration?

        # The resource that was most recently analyzed by the analyzer.
        @[JSON::Field(key: "lastResourceAnalyzed")]
        getter last_resource_analyzed : String?

        # The time at which the most recently analyzed resource was analyzed.
        @[JSON::Field(key: "lastResourceAnalyzedAt")]
        getter last_resource_analyzed_at : Time?

        # The statusReason provides more details about the current status of the analyzer. For example, if the
        # creation for the analyzer fails, a Failed status is returned. For an analyzer with organization as
        # the type, this failure can be due to an issue with creating the service-linked roles required in the
        # member accounts of the Amazon Web Services organization.
        @[JSON::Field(key: "statusReason")]
        getter status_reason : Types::StatusReason?

        # An array of key-value pairs applied to the analyzer. The key-value pairs consist of the set of
        # Unicode letters, digits, whitespace, _ , . , / , = , + , and - . The tag key is a value that is 1 to
        # 128 characters in length and cannot be prefixed with aws: . The tag value is a value that is 0 to
        # 256 characters in length.
        @[JSON::Field(key: "tags")]
        getter tags : Hash(String, String)?

        def initialize(
          @arn : String,
          @created_at : Time,
          @name : String,
          @status : String,
          @type : String,
          @configuration : Types::AnalyzerConfiguration? = nil,
          @last_resource_analyzed : String? = nil,
          @last_resource_analyzed_at : Time? = nil,
          @status_reason : Types::StatusReason? = nil,
          @tags : Hash(String, String)? = nil
        )
        end
      end

      # Retroactively applies an archive rule.
      struct ApplyArchiveRuleRequest
        include JSON::Serializable

        # The Amazon resource name (ARN) of the analyzer.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The name of the rule to apply.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        def initialize(
          @analyzer_arn : String,
          @rule_name : String,
          @client_token : String? = nil
        )
        end
      end

      # Contains information about an archive rule. Archive rules automatically archive new findings that
      # meet the criteria you define when you create the rule.
      struct ArchiveRuleSummary
        include JSON::Serializable

        # The time at which the archive rule was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # A filter used to define the archive rule.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)

        # The name of the archive rule.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        # The time at which the archive rule was last updated.
        @[JSON::Field(key: "updatedAt")]
        getter updated_at : Time

        def initialize(
          @created_at : Time,
          @filter : Hash(String, Types::Criterion),
          @rule_name : String,
          @updated_at : Time
        )
        end
      end

      struct CancelPolicyGenerationRequest
        include JSON::Serializable

        # The JobId that is returned by the StartPolicyGeneration operation. The JobId can be used with
        # GetGeneratedPolicy to retrieve the generated policies or used with CancelPolicyGeneration to cancel
        # the policy generation request.
        @[JSON::Field(key: "jobId")]
        getter job_id : String

        def initialize(
          @job_id : String
        )
        end
      end

      struct CancelPolicyGenerationResponse
        include JSON::Serializable

        def initialize
        end
      end

      struct CheckAccessNotGrantedRequest
        include JSON::Serializable

        # An access object containing the permissions that shouldn't be granted by the specified policy. If
        # only actions are specified, IAM Access Analyzer checks for access to peform at least one of the
        # actions on any resource in the policy. If only resources are specified, then IAM Access Analyzer
        # checks for access to perform any action on at least one of the resources. If both actions and
        # resources are specified, IAM Access Analyzer checks for access to perform at least one of the
        # specified actions on at least one of the specified resources.
        @[JSON::Field(key: "access")]
        getter access : Array(Types::Access)

        # The JSON policy document to use as the content for the policy.
        @[JSON::Field(key: "policyDocument")]
        getter policy_document : String

        # The type of policy. Identity policies grant permissions to IAM principals. Identity policies include
        # managed and inline policies for IAM roles, users, and groups. Resource policies grant permissions on
        # Amazon Web Services resources. Resource policies include trust policies for IAM roles and bucket
        # policies for Amazon S3 buckets.
        @[JSON::Field(key: "policyType")]
        getter policy_type : String

        def initialize(
          @access : Array(Types::Access),
          @policy_document : String,
          @policy_type : String
        )
        end
      end

      struct CheckAccessNotGrantedResponse
        include JSON::Serializable

        # The message indicating whether the specified access is allowed.
        @[JSON::Field(key: "message")]
        getter message : String?

        # A description of the reasoning of the result.
        @[JSON::Field(key: "reasons")]
        getter reasons : Array(Types::ReasonSummary)?

        # The result of the check for whether the access is allowed. If the result is PASS , the specified
        # policy doesn't allow any of the specified permissions in the access object. If the result is FAIL ,
        # the specified policy might allow some or all of the permissions in the access object.
        @[JSON::Field(key: "result")]
        getter result : String?

        def initialize(
          @message : String? = nil,
          @reasons : Array(Types::ReasonSummary)? = nil,
          @result : String? = nil
        )
        end
      end

      struct CheckNoNewAccessRequest
        include JSON::Serializable

        # The JSON policy document to use as the content for the existing policy.
        @[JSON::Field(key: "existingPolicyDocument")]
        getter existing_policy_document : String

        # The JSON policy document to use as the content for the updated policy.
        @[JSON::Field(key: "newPolicyDocument")]
        getter new_policy_document : String

        # The type of policy to compare. Identity policies grant permissions to IAM principals. Identity
        # policies include managed and inline policies for IAM roles, users, and groups. Resource policies
        # grant permissions on Amazon Web Services resources. Resource policies include trust policies for IAM
        # roles and bucket policies for Amazon S3 buckets. You can provide a generic input such as identity
        # policy or resource policy or a specific input such as managed policy or Amazon S3 bucket policy.
        @[JSON::Field(key: "policyType")]
        getter policy_type : String

        def initialize(
          @existing_policy_document : String,
          @new_policy_document : String,
          @policy_type : String
        )
        end
      end

      struct CheckNoNewAccessResponse
        include JSON::Serializable

        # The message indicating whether the updated policy allows new access.
        @[JSON::Field(key: "message")]
        getter message : String?

        # A description of the reasoning of the result.
        @[JSON::Field(key: "reasons")]
        getter reasons : Array(Types::ReasonSummary)?

        # The result of the check for new access. If the result is PASS , no new access is allowed by the
        # updated policy. If the result is FAIL , the updated policy might allow new access.
        @[JSON::Field(key: "result")]
        getter result : String?

        def initialize(
          @message : String? = nil,
          @reasons : Array(Types::ReasonSummary)? = nil,
          @result : String? = nil
        )
        end
      end

      struct CheckNoPublicAccessRequest
        include JSON::Serializable

        # The JSON policy document to evaluate for public access.
        @[JSON::Field(key: "policyDocument")]
        getter policy_document : String

        # The type of resource to evaluate for public access. For example, to check for public access to
        # Amazon S3 buckets, you can choose AWS::S3::Bucket for the resource type. For resource types not
        # supported as valid values, IAM Access Analyzer will return an error.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        def initialize(
          @policy_document : String,
          @resource_type : String
        )
        end
      end

      struct CheckNoPublicAccessResponse
        include JSON::Serializable

        # The message indicating whether the specified policy allows public access to resources.
        @[JSON::Field(key: "message")]
        getter message : String?

        # A list of reasons why the specified resource policy grants public access for the resource type.
        @[JSON::Field(key: "reasons")]
        getter reasons : Array(Types::ReasonSummary)?

        # The result of the check for public access to the specified resource type. If the result is PASS ,
        # the policy doesn't allow public access to the specified resource type. If the result is FAIL , the
        # policy might allow public access to the specified resource type.
        @[JSON::Field(key: "result")]
        getter result : String?

        def initialize(
          @message : String? = nil,
          @reasons : Array(Types::ReasonSummary)? = nil,
          @result : String? = nil
        )
        end
      end

      # Contains information about CloudTrail access.
      struct CloudTrailDetails
        include JSON::Serializable

        # The ARN of the service role that IAM Access Analyzer uses to access your CloudTrail trail and
        # service last accessed information.
        @[JSON::Field(key: "accessRole")]
        getter access_role : String

        # The start of the time range for which IAM Access Analyzer reviews your CloudTrail events. Events
        # with a timestamp before this time are not considered to generate a policy.
        @[JSON::Field(key: "startTime")]
        getter start_time : Time

        # A Trail object that contains settings for a trail.
        @[JSON::Field(key: "trails")]
        getter trails : Array(Types::Trail)

        # The end of the time range for which IAM Access Analyzer reviews your CloudTrail events. Events with
        # a timestamp after this time are not considered to generate a policy. If this is not included in the
        # request, the default value is the current time.
        @[JSON::Field(key: "endTime")]
        getter end_time : Time?

        def initialize(
          @access_role : String,
          @start_time : Time,
          @trails : Array(Types::Trail),
          @end_time : Time? = nil
        )
        end
      end

      # Contains information about CloudTrail access.
      struct CloudTrailProperties
        include JSON::Serializable

        # The end of the time range for which IAM Access Analyzer reviews your CloudTrail events. Events with
        # a timestamp after this time are not considered to generate a policy. If this is not included in the
        # request, the default value is the current time.
        @[JSON::Field(key: "endTime")]
        getter end_time : Time

        # The start of the time range for which IAM Access Analyzer reviews your CloudTrail events. Events
        # with a timestamp before this time are not considered to generate a policy.
        @[JSON::Field(key: "startTime")]
        getter start_time : Time

        # A TrailProperties object that contains settings for trail properties.
        @[JSON::Field(key: "trailProperties")]
        getter trail_properties : Array(Types::TrailProperties)

        def initialize(
          @end_time : Time,
          @start_time : Time,
          @trail_properties : Array(Types::TrailProperties)
        )
        end
      end

      # Access control configuration structures for your resource. You specify the configuration as a
      # type-value pair. You can specify only one type of access control configuration.
      struct Configuration
        include JSON::Serializable

        # The access control configuration is for a DynamoDB stream.
        @[JSON::Field(key: "dynamodbStream")]
        getter dynamodb_stream : Types::DynamodbStreamConfiguration?

        # The access control configuration is for a DynamoDB table or index.
        @[JSON::Field(key: "dynamodbTable")]
        getter dynamodb_table : Types::DynamodbTableConfiguration?

        # The access control configuration is for an Amazon EBS volume snapshot.
        @[JSON::Field(key: "ebsSnapshot")]
        getter ebs_snapshot : Types::EbsSnapshotConfiguration?

        # The access control configuration is for an Amazon ECR repository.
        @[JSON::Field(key: "ecrRepository")]
        getter ecr_repository : Types::EcrRepositoryConfiguration?

        # The access control configuration is for an Amazon EFS file system.
        @[JSON::Field(key: "efsFileSystem")]
        getter efs_file_system : Types::EfsFileSystemConfiguration?

        # The access control configuration is for an IAM role.
        @[JSON::Field(key: "iamRole")]
        getter iam_role : Types::IamRoleConfiguration?

        # The access control configuration is for a KMS key.
        @[JSON::Field(key: "kmsKey")]
        getter kms_key : Types::KmsKeyConfiguration?

        # The access control configuration is for an Amazon RDS DB cluster snapshot.
        @[JSON::Field(key: "rdsDbClusterSnapshot")]
        getter rds_db_cluster_snapshot : Types::RdsDbClusterSnapshotConfiguration?

        # The access control configuration is for an Amazon RDS DB snapshot.
        @[JSON::Field(key: "rdsDbSnapshot")]
        getter rds_db_snapshot : Types::RdsDbSnapshotConfiguration?

        # The access control configuration is for an Amazon S3 bucket.
        @[JSON::Field(key: "s3Bucket")]
        getter s3_bucket : Types::S3BucketConfiguration?

        # The access control configuration is for an Amazon S3 directory bucket.
        @[JSON::Field(key: "s3ExpressDirectoryBucket")]
        getter s3_express_directory_bucket : Types::S3ExpressDirectoryBucketConfiguration?

        # The access control configuration is for a Secrets Manager secret.
        @[JSON::Field(key: "secretsManagerSecret")]
        getter secrets_manager_secret : Types::SecretsManagerSecretConfiguration?

        # The access control configuration is for an Amazon SNS topic
        @[JSON::Field(key: "snsTopic")]
        getter sns_topic : Types::SnsTopicConfiguration?

        # The access control configuration is for an Amazon SQS queue.
        @[JSON::Field(key: "sqsQueue")]
        getter sqs_queue : Types::SqsQueueConfiguration?

        def initialize(
          @dynamodb_stream : Types::DynamodbStreamConfiguration? = nil,
          @dynamodb_table : Types::DynamodbTableConfiguration? = nil,
          @ebs_snapshot : Types::EbsSnapshotConfiguration? = nil,
          @ecr_repository : Types::EcrRepositoryConfiguration? = nil,
          @efs_file_system : Types::EfsFileSystemConfiguration? = nil,
          @iam_role : Types::IamRoleConfiguration? = nil,
          @kms_key : Types::KmsKeyConfiguration? = nil,
          @rds_db_cluster_snapshot : Types::RdsDbClusterSnapshotConfiguration? = nil,
          @rds_db_snapshot : Types::RdsDbSnapshotConfiguration? = nil,
          @s3_bucket : Types::S3BucketConfiguration? = nil,
          @s3_express_directory_bucket : Types::S3ExpressDirectoryBucketConfiguration? = nil,
          @secrets_manager_secret : Types::SecretsManagerSecretConfiguration? = nil,
          @sns_topic : Types::SnsTopicConfiguration? = nil,
          @sqs_queue : Types::SqsQueueConfiguration? = nil
        )
        end
      end

      # A conflict exception error.
      struct ConflictException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        # The ID of the resource.
        @[JSON::Field(key: "resourceId")]
        getter resource_id : String

        # The resource type.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        def initialize(
          @message : String,
          @resource_id : String,
          @resource_type : String
        )
        end
      end

      struct CreateAccessPreviewRequest
        include JSON::Serializable

        # The ARN of the account analyzer used to generate the access preview. You can only create an access
        # preview for analyzers with an Account type and Active status.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # Access control configuration for your resource that is used to generate the access preview. The
        # access preview includes findings for external access allowed to the resource with the proposed
        # access control configuration. The configuration must contain exactly one element.
        @[JSON::Field(key: "configurations")]
        getter configurations : Hash(String, Types::Configuration)

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        def initialize(
          @analyzer_arn : String,
          @configurations : Hash(String, Types::Configuration),
          @client_token : String? = nil
        )
        end
      end

      struct CreateAccessPreviewResponse
        include JSON::Serializable

        # The unique ID for the access preview.
        @[JSON::Field(key: "id")]
        getter id : String

        def initialize(
          @id : String
        )
        end
      end

      # Creates an analyzer.
      struct CreateAnalyzerRequest
        include JSON::Serializable

        # The name of the analyzer to create.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # The type of analyzer to create. You can create only one analyzer per account per Region. You can
        # create up to 5 analyzers per organization per Region.
        @[JSON::Field(key: "type")]
        getter type : String

        # Specifies the archive rules to add for the analyzer. Archive rules automatically archive findings
        # that meet the criteria you define for the rule.
        @[JSON::Field(key: "archiveRules")]
        getter archive_rules : Array(Types::InlineArchiveRule)?

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        # Specifies the configuration of the analyzer. If the analyzer is an unused access analyzer, the
        # specified scope of unused access is used for the configuration. If the analyzer is an internal
        # access analyzer, the specified internal access analysis rules are used for the configuration.
        @[JSON::Field(key: "configuration")]
        getter configuration : Types::AnalyzerConfiguration?

        # An array of key-value pairs to apply to the analyzer. You can use the set of Unicode letters,
        # digits, whitespace, _ , . , / , = , + , and - . For the tag key, you can specify a value that is 1
        # to 128 characters in length and cannot be prefixed with aws: . For the tag value, you can specify a
        # value that is 0 to 256 characters in length.
        @[JSON::Field(key: "tags")]
        getter tags : Hash(String, String)?

        def initialize(
          @analyzer_name : String,
          @type : String,
          @archive_rules : Array(Types::InlineArchiveRule)? = nil,
          @client_token : String? = nil,
          @configuration : Types::AnalyzerConfiguration? = nil,
          @tags : Hash(String, String)? = nil
        )
        end
      end

      # The response to the request to create an analyzer.
      struct CreateAnalyzerResponse
        include JSON::Serializable

        # The ARN of the analyzer that was created by the request.
        @[JSON::Field(key: "arn")]
        getter arn : String?

        def initialize(
          @arn : String? = nil
        )
        end
      end

      # Creates an archive rule.
      struct CreateArchiveRuleRequest
        include JSON::Serializable

        # The name of the created analyzer.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # The criteria for the rule.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)

        # The name of the rule to create.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        def initialize(
          @analyzer_name : String,
          @filter : Hash(String, Types::Criterion),
          @rule_name : String,
          @client_token : String? = nil
        )
        end
      end

      # The criteria to use in the filter that defines the archive rule. For more information on available
      # filter keys, see IAM Access Analyzer filter keys .
      struct Criterion
        include JSON::Serializable

        # A "contains" operator to match for the filter used to create the rule.
        @[JSON::Field(key: "contains")]
        getter contains : Array(String)?

        # An "equals" operator to match for the filter used to create the rule.
        @[JSON::Field(key: "eq")]
        getter eq : Array(String)?

        # An "exists" operator to match for the filter used to create the rule.
        @[JSON::Field(key: "exists")]
        getter exists : Bool?

        # A "not equals" operator to match for the filter used to create the rule.
        @[JSON::Field(key: "neq")]
        getter neq : Array(String)?

        def initialize(
          @contains : Array(String)? = nil,
          @eq : Array(String)? = nil,
          @exists : Bool? = nil,
          @neq : Array(String)? = nil
        )
        end
      end

      # Deletes an analyzer.
      struct DeleteAnalyzerRequest
        include JSON::Serializable

        # The name of the analyzer to delete.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        def initialize(
          @analyzer_name : String,
          @client_token : String? = nil
        )
        end
      end

      # Deletes an archive rule.
      struct DeleteArchiveRuleRequest
        include JSON::Serializable

        # The name of the analyzer that associated with the archive rule to delete.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # The name of the rule to delete.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        def initialize(
          @analyzer_name : String,
          @rule_name : String,
          @client_token : String? = nil
        )
        end
      end

      # The proposed access control configuration for a DynamoDB stream. You can propose a configuration for
      # a new DynamoDB stream or an existing DynamoDB stream that you own by specifying the policy for the
      # DynamoDB stream. For more information, see PutResourcePolicy . If the configuration is for an
      # existing DynamoDB stream and you do not specify the DynamoDB policy, then the access preview uses
      # the existing DynamoDB policy for the stream. If the access preview is for a new resource and you do
      # not specify the policy, then the access preview assumes a DynamoDB stream without a policy. To
      # propose deletion of an existing DynamoDB stream policy, you can specify an empty string for the
      # DynamoDB policy.
      struct DynamodbStreamConfiguration
        include JSON::Serializable

        # The proposed resource policy defining who can access or manage the DynamoDB stream.
        @[JSON::Field(key: "streamPolicy")]
        getter stream_policy : String?

        def initialize(
          @stream_policy : String? = nil
        )
        end
      end

      # The proposed access control configuration for a DynamoDB table or index. You can propose a
      # configuration for a new DynamoDB table or index or an existing DynamoDB table or index that you own
      # by specifying the policy for the DynamoDB table or index. For more information, see
      # PutResourcePolicy . If the configuration is for an existing DynamoDB table or index and you do not
      # specify the DynamoDB policy, then the access preview uses the existing DynamoDB policy for the table
      # or index. If the access preview is for a new resource and you do not specify the policy, then the
      # access preview assumes a DynamoDB table without a policy. To propose deletion of an existing
      # DynamoDB table or index policy, you can specify an empty string for the DynamoDB policy.
      struct DynamodbTableConfiguration
        include JSON::Serializable

        # The proposed resource policy defining who can access or manage the DynamoDB table.
        @[JSON::Field(key: "tablePolicy")]
        getter table_policy : String?

        def initialize(
          @table_policy : String? = nil
        )
        end
      end

      # The proposed access control configuration for an Amazon EBS volume snapshot. You can propose a
      # configuration for a new Amazon EBS volume snapshot or an Amazon EBS volume snapshot that you own by
      # specifying the user IDs, groups, and optional KMS encryption key. For more information, see
      # ModifySnapshotAttribute .
      struct EbsSnapshotConfiguration
        include JSON::Serializable

        # The groups that have access to the Amazon EBS volume snapshot. If the value all is specified, then
        # the Amazon EBS volume snapshot is public. If the configuration is for an existing Amazon EBS volume
        # snapshot and you do not specify the groups , then the access preview uses the existing shared groups
        # for the snapshot. If the access preview is for a new resource and you do not specify the groups ,
        # then the access preview considers the snapshot without any groups . To propose deletion of existing
        # shared groups , you can specify an empty list for groups .
        @[JSON::Field(key: "groups")]
        getter groups : Array(String)?

        # The KMS key identifier for an encrypted Amazon EBS volume snapshot. The KMS key identifier is the
        # key ARN, key ID, alias ARN, or alias name for the KMS key. If the configuration is for an existing
        # Amazon EBS volume snapshot and you do not specify the kmsKeyId , or you specify an empty string,
        # then the access preview uses the existing kmsKeyId of the snapshot. If the access preview is for a
        # new resource and you do not specify the kmsKeyId , the access preview considers the snapshot as
        # unencrypted.
        @[JSON::Field(key: "kmsKeyId")]
        getter kms_key_id : String?

        # The IDs of the Amazon Web Services accounts that have access to the Amazon EBS volume snapshot. If
        # the configuration is for an existing Amazon EBS volume snapshot and you do not specify the userIds ,
        # then the access preview uses the existing shared userIds for the snapshot. If the access preview is
        # for a new resource and you do not specify the userIds , then the access preview considers the
        # snapshot without any userIds . To propose deletion of existing shared accountIds , you can specify
        # an empty list for userIds .
        @[JSON::Field(key: "userIds")]
        getter user_ids : Array(String)?

        def initialize(
          @groups : Array(String)? = nil,
          @kms_key_id : String? = nil,
          @user_ids : Array(String)? = nil
        )
        end
      end

      # The proposed access control configuration for an Amazon ECR repository. You can propose a
      # configuration for a new Amazon ECR repository or an existing Amazon ECR repository that you own by
      # specifying the Amazon ECR policy. For more information, see Repository . If the configuration is for
      # an existing Amazon ECR repository and you do not specify the Amazon ECR policy, then the access
      # preview uses the existing Amazon ECR policy for the repository. If the access preview is for a new
      # resource and you do not specify the policy, then the access preview assumes an Amazon ECR repository
      # without a policy. To propose deletion of an existing Amazon ECR repository policy, you can specify
      # an empty string for the Amazon ECR policy.
      struct EcrRepositoryConfiguration
        include JSON::Serializable

        # The JSON repository policy text to apply to the Amazon ECR repository. For more information, see
        # Private repository policy examples in the Amazon ECR User Guide .
        @[JSON::Field(key: "repositoryPolicy")]
        getter repository_policy : String?

        def initialize(
          @repository_policy : String? = nil
        )
        end
      end

      # The proposed access control configuration for an Amazon EFS file system. You can propose a
      # configuration for a new Amazon EFS file system or an existing Amazon EFS file system that you own by
      # specifying the Amazon EFS policy. For more information, see Using file systems in Amazon EFS . If
      # the configuration is for an existing Amazon EFS file system and you do not specify the Amazon EFS
      # policy, then the access preview uses the existing Amazon EFS policy for the file system. If the
      # access preview is for a new resource and you do not specify the policy, then the access preview
      # assumes an Amazon EFS file system without a policy. To propose deletion of an existing Amazon EFS
      # file system policy, you can specify an empty string for the Amazon EFS policy.
      struct EfsFileSystemConfiguration
        include JSON::Serializable

        # The JSON policy definition to apply to the Amazon EFS file system. For more information on the
        # elements that make up a file system policy, see Amazon EFS Resource-based policies .
        @[JSON::Field(key: "fileSystemPolicy")]
        getter file_system_policy : String?

        def initialize(
          @file_system_policy : String? = nil
        )
        end
      end

      # Contains information about an external access finding.
      struct ExternalAccessDetails
        include JSON::Serializable

        # The condition in the analyzed policy statement that resulted in an external access finding.
        @[JSON::Field(key: "condition")]
        getter condition : Hash(String, String)

        # The action in the analyzed policy statement that an external principal has permission to use.
        @[JSON::Field(key: "action")]
        getter action : Array(String)?

        # Specifies whether the external access finding is public.
        @[JSON::Field(key: "isPublic")]
        getter is_public : Bool?

        # The external principal that has access to a resource within the zone of trust.
        @[JSON::Field(key: "principal")]
        getter principal : Hash(String, String)?

        # The type of restriction applied to the finding by the resource owner with an Organizations resource
        # control policy (RCP). APPLICABLE : There is an RCP present in the organization but IAM Access
        # Analyzer does not include it in the evaluation of effective permissions. For example, if
        # s3:DeleteObject is blocked by the RCP and the restriction is APPLICABLE , then s3:DeleteObject would
        # still be included in the list of actions for the finding. FAILED_TO_EVALUATE_RCP : There was an
        # error evaluating the RCP. NOT_APPLICABLE : There was no RCP present in the organization, or there
        # was no RCP applicable to the resource. For example, the resource being analyzed is an Amazon RDS
        # snapshot and there is an RCP in the organization, but the RCP only impacts Amazon S3 buckets.
        # APPLIED : This restriction is not currently available for external access findings.
        @[JSON::Field(key: "resourceControlPolicyRestriction")]
        getter resource_control_policy_restriction : String?

        # The sources of the external access finding. This indicates how the access that generated the finding
        # is granted. It is populated for Amazon S3 bucket findings.
        @[JSON::Field(key: "sources")]
        getter sources : Array(Types::FindingSource)?

        def initialize(
          @condition : Hash(String, String),
          @action : Array(String)? = nil,
          @is_public : Bool? = nil,
          @principal : Hash(String, String)? = nil,
          @resource_control_policy_restriction : String? = nil,
          @sources : Array(Types::FindingSource)? = nil
        )
        end
      end

      # Provides aggregate statistics about the findings for the specified external access analyzer.
      struct ExternalAccessFindingsStatistics
        include JSON::Serializable

        # The total number of active cross-account and public findings for each resource type of the specified
        # external access analyzer.
        @[JSON::Field(key: "resourceTypeStatistics")]
        getter resource_type_statistics : Hash(String, Types::ResourceTypeDetails)?

        # The number of active findings for the specified external access analyzer.
        @[JSON::Field(key: "totalActiveFindings")]
        getter total_active_findings : Int32?

        # The number of archived findings for the specified external access analyzer.
        @[JSON::Field(key: "totalArchivedFindings")]
        getter total_archived_findings : Int32?

        # The number of resolved findings for the specified external access analyzer.
        @[JSON::Field(key: "totalResolvedFindings")]
        getter total_resolved_findings : Int32?

        def initialize(
          @resource_type_statistics : Hash(String, Types::ResourceTypeDetails)? = nil,
          @total_active_findings : Int32? = nil,
          @total_archived_findings : Int32? = nil,
          @total_resolved_findings : Int32? = nil
        )
        end
      end

      # Contains information about a finding.
      struct Finding
        include JSON::Serializable

        # The time at which the resource was analyzed.
        @[JSON::Field(key: "analyzedAt")]
        getter analyzed_at : Time

        # The condition in the analyzed policy statement that resulted in a finding.
        @[JSON::Field(key: "condition")]
        getter condition : Hash(String, String)

        # The time at which the finding was generated.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The ID of the finding.
        @[JSON::Field(key: "id")]
        getter id : String

        # The Amazon Web Services account ID that owns the resource.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of the resource identified in the finding.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        # The current status of the finding.
        @[JSON::Field(key: "status")]
        getter status : String

        # The time at which the finding was updated.
        @[JSON::Field(key: "updatedAt")]
        getter updated_at : Time

        # The action in the analyzed policy statement that an external principal has permission to use.
        @[JSON::Field(key: "action")]
        getter action : Array(String)?

        # An error.
        @[JSON::Field(key: "error")]
        getter error : String?

        # Indicates whether the policy that generated the finding allows public access to the resource.
        @[JSON::Field(key: "isPublic")]
        getter is_public : Bool?

        # The external principal that has access to a resource within the zone of trust.
        @[JSON::Field(key: "principal")]
        getter principal : Hash(String, String)?

        # The resource that an external principal has access to.
        @[JSON::Field(key: "resource")]
        getter resource : String?

        # The type of restriction applied to the finding by the resource owner with an Organizations resource
        # control policy (RCP).
        @[JSON::Field(key: "resourceControlPolicyRestriction")]
        getter resource_control_policy_restriction : String?

        # The sources of the finding. This indicates how the access that generated the finding is granted. It
        # is populated for Amazon S3 bucket findings.
        @[JSON::Field(key: "sources")]
        getter sources : Array(Types::FindingSource)?

        def initialize(
          @analyzed_at : Time,
          @condition : Hash(String, String),
          @created_at : Time,
          @id : String,
          @resource_owner_account : String,
          @resource_type : String,
          @status : String,
          @updated_at : Time,
          @action : Array(String)? = nil,
          @error : String? = nil,
          @is_public : Bool? = nil,
          @principal : Hash(String, String)? = nil,
          @resource : String? = nil,
          @resource_control_policy_restriction : String? = nil,
          @sources : Array(Types::FindingSource)? = nil
        )
        end
      end

      # Contains information about the findings for an Amazon Web Services account in an organization unused
      # access analyzer.
      struct FindingAggregationAccountDetails
        include JSON::Serializable

        # The ID of the Amazon Web Services account for which unused access finding details are provided.
        @[JSON::Field(key: "account")]
        getter account : String?

        # Provides the number of active findings for each type of unused access for the specified Amazon Web
        # Services account.
        @[JSON::Field(key: "details")]
        getter details : Hash(String, Int32)?

        # The number of active unused access findings for the specified Amazon Web Services account.
        @[JSON::Field(key: "numberOfActiveFindings")]
        getter number_of_active_findings : Int32?

        def initialize(
          @account : String? = nil,
          @details : Hash(String, Int32)? = nil,
          @number_of_active_findings : Int32? = nil
        )
        end
      end

      # Contains information about an external access or unused access finding. Only one parameter can be
      # used in a FindingDetails object.
      struct FindingDetails
        include JSON::Serializable

        # The details for an external access analyzer finding.
        @[JSON::Field(key: "externalAccessDetails")]
        getter external_access_details : Types::ExternalAccessDetails?

        # The details for an internal access analyzer finding. This contains information about access patterns
        # identified within your Amazon Web Services organization or account.
        @[JSON::Field(key: "internalAccessDetails")]
        getter internal_access_details : Types::InternalAccessDetails?

        # The details for an unused access analyzer finding with an unused IAM role finding type.
        @[JSON::Field(key: "unusedIamRoleDetails")]
        getter unused_iam_role_details : Types::UnusedIamRoleDetails?

        # The details for an unused access analyzer finding with an unused IAM user access key finding type.
        @[JSON::Field(key: "unusedIamUserAccessKeyDetails")]
        getter unused_iam_user_access_key_details : Types::UnusedIamUserAccessKeyDetails?

        # The details for an unused access analyzer finding with an unused IAM user password finding type.
        @[JSON::Field(key: "unusedIamUserPasswordDetails")]
        getter unused_iam_user_password_details : Types::UnusedIamUserPasswordDetails?

        # The details for an unused access analyzer finding with an unused permission finding type.
        @[JSON::Field(key: "unusedPermissionDetails")]
        getter unused_permission_details : Types::UnusedPermissionDetails?

        def initialize(
          @external_access_details : Types::ExternalAccessDetails? = nil,
          @internal_access_details : Types::InternalAccessDetails? = nil,
          @unused_iam_role_details : Types::UnusedIamRoleDetails? = nil,
          @unused_iam_user_access_key_details : Types::UnusedIamUserAccessKeyDetails? = nil,
          @unused_iam_user_password_details : Types::UnusedIamUserPasswordDetails? = nil,
          @unused_permission_details : Types::UnusedPermissionDetails? = nil
        )
        end
      end

      # The source of the finding. This indicates how the access that generated the finding is granted. It
      # is populated for Amazon S3 bucket findings.
      struct FindingSource
        include JSON::Serializable

        # Indicates the type of access that generated the finding.
        @[JSON::Field(key: "type")]
        getter type : String

        # Includes details about how the access that generated the finding is granted. This is populated for
        # Amazon S3 bucket findings.
        @[JSON::Field(key: "detail")]
        getter detail : Types::FindingSourceDetail?

        def initialize(
          @type : String,
          @detail : Types::FindingSourceDetail? = nil
        )
        end
      end

      # Includes details about how the access that generated the finding is granted. This is populated for
      # Amazon S3 bucket findings.
      struct FindingSourceDetail
        include JSON::Serializable

        # The account of the cross-account access point that generated the finding.
        @[JSON::Field(key: "accessPointAccount")]
        getter access_point_account : String?

        # The ARN of the access point that generated the finding. The ARN format depends on whether the ARN
        # represents an access point or a multi-region access point.
        @[JSON::Field(key: "accessPointArn")]
        getter access_point_arn : String?

        def initialize(
          @access_point_account : String? = nil,
          @access_point_arn : String? = nil
        )
        end
      end

      # Contains information about a finding.
      struct FindingSummary
        include JSON::Serializable

        # The time at which the resource-based policy that generated the finding was analyzed.
        @[JSON::Field(key: "analyzedAt")]
        getter analyzed_at : Time

        # The condition in the analyzed policy statement that resulted in a finding.
        @[JSON::Field(key: "condition")]
        getter condition : Hash(String, String)

        # The time at which the finding was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The ID of the finding.
        @[JSON::Field(key: "id")]
        getter id : String

        # The Amazon Web Services account ID that owns the resource.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of the resource that the external principal has access to.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        # The status of the finding.
        @[JSON::Field(key: "status")]
        getter status : String

        # The time at which the finding was most recently updated.
        @[JSON::Field(key: "updatedAt")]
        getter updated_at : Time

        # The action in the analyzed policy statement that an external principal has permission to use.
        @[JSON::Field(key: "action")]
        getter action : Array(String)?

        # The error that resulted in an Error finding.
        @[JSON::Field(key: "error")]
        getter error : String?

        # Indicates whether the finding reports a resource that has a policy that allows public access.
        @[JSON::Field(key: "isPublic")]
        getter is_public : Bool?

        # The external principal that has access to a resource within the zone of trust.
        @[JSON::Field(key: "principal")]
        getter principal : Hash(String, String)?

        # The resource that the external principal has access to.
        @[JSON::Field(key: "resource")]
        getter resource : String?

        # The type of restriction applied to the finding by the resource owner with an Organizations resource
        # control policy (RCP).
        @[JSON::Field(key: "resourceControlPolicyRestriction")]
        getter resource_control_policy_restriction : String?

        # The sources of the finding. This indicates how the access that generated the finding is granted. It
        # is populated for Amazon S3 bucket findings.
        @[JSON::Field(key: "sources")]
        getter sources : Array(Types::FindingSource)?

        def initialize(
          @analyzed_at : Time,
          @condition : Hash(String, String),
          @created_at : Time,
          @id : String,
          @resource_owner_account : String,
          @resource_type : String,
          @status : String,
          @updated_at : Time,
          @action : Array(String)? = nil,
          @error : String? = nil,
          @is_public : Bool? = nil,
          @principal : Hash(String, String)? = nil,
          @resource : String? = nil,
          @resource_control_policy_restriction : String? = nil,
          @sources : Array(Types::FindingSource)? = nil
        )
        end
      end

      # Contains information about a finding.
      struct FindingSummaryV2
        include JSON::Serializable

        # The time at which the resource-based policy or IAM entity that generated the finding was analyzed.
        @[JSON::Field(key: "analyzedAt")]
        getter analyzed_at : Time

        # The time at which the finding was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # The ID of the finding.
        @[JSON::Field(key: "id")]
        getter id : String

        # The Amazon Web Services account ID that owns the resource.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of the resource that the external principal has access to.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        # The status of the finding.
        @[JSON::Field(key: "status")]
        getter status : String

        # The time at which the finding was most recently updated.
        @[JSON::Field(key: "updatedAt")]
        getter updated_at : Time

        # The error that resulted in an Error finding.
        @[JSON::Field(key: "error")]
        getter error : String?

        # The type of the access finding. For external access analyzers, the type is ExternalAccess . For
        # unused access analyzers, the type can be UnusedIAMRole , UnusedIAMUserAccessKey ,
        # UnusedIAMUserPassword , or UnusedPermission . For internal access analyzers, the type is
        # InternalAccess .
        @[JSON::Field(key: "findingType")]
        getter finding_type : String?

        # The resource that the external principal has access to.
        @[JSON::Field(key: "resource")]
        getter resource : String?

        def initialize(
          @analyzed_at : Time,
          @created_at : Time,
          @id : String,
          @resource_owner_account : String,
          @resource_type : String,
          @status : String,
          @updated_at : Time,
          @error : String? = nil,
          @finding_type : String? = nil,
          @resource : String? = nil
        )
        end
      end

      # Contains information about the aggregate statistics for an external or unused access analyzer. Only
      # one parameter can be used in a FindingsStatistics object.
      struct FindingsStatistics
        include JSON::Serializable

        # The aggregate statistics for an external access analyzer.
        @[JSON::Field(key: "externalAccessFindingsStatistics")]
        getter external_access_findings_statistics : Types::ExternalAccessFindingsStatistics?

        # The aggregate statistics for an internal access analyzer. This includes information about active,
        # archived, and resolved findings related to internal access within your Amazon Web Services
        # organization or account.
        @[JSON::Field(key: "internalAccessFindingsStatistics")]
        getter internal_access_findings_statistics : Types::InternalAccessFindingsStatistics?

        # The aggregate statistics for an unused access analyzer.
        @[JSON::Field(key: "unusedAccessFindingsStatistics")]
        getter unused_access_findings_statistics : Types::UnusedAccessFindingsStatistics?

        def initialize(
          @external_access_findings_statistics : Types::ExternalAccessFindingsStatistics? = nil,
          @internal_access_findings_statistics : Types::InternalAccessFindingsStatistics? = nil,
          @unused_access_findings_statistics : Types::UnusedAccessFindingsStatistics? = nil
        )
        end
      end

      struct GenerateFindingRecommendationRequest
        include JSON::Serializable

        # The ARN of the analyzer used to generate the finding recommendation.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The unique ID for the finding recommendation.
        @[JSON::Field(key: "id")]
        getter id : String

        def initialize(
          @analyzer_arn : String,
          @id : String
        )
        end
      end

      # Contains the text for the generated policy.
      struct GeneratedPolicy
        include JSON::Serializable

        # The text to use as the content for the new policy. The policy is created using the CreatePolicy
        # action.
        @[JSON::Field(key: "policy")]
        getter policy : String

        def initialize(
          @policy : String
        )
        end
      end

      # Contains the generated policy details.
      struct GeneratedPolicyProperties
        include JSON::Serializable

        # The ARN of the IAM entity (user or role) for which you are generating a policy.
        @[JSON::Field(key: "principalArn")]
        getter principal_arn : String

        # Lists details about the Trail used to generated policy.
        @[JSON::Field(key: "cloudTrailProperties")]
        getter cloud_trail_properties : Types::CloudTrailProperties?

        # This value is set to true if the generated policy contains all possible actions for a service that
        # IAM Access Analyzer identified from the CloudTrail trail that you specified, and false otherwise.
        @[JSON::Field(key: "isComplete")]
        getter is_complete : Bool?

        def initialize(
          @principal_arn : String,
          @cloud_trail_properties : Types::CloudTrailProperties? = nil,
          @is_complete : Bool? = nil
        )
        end
      end

      # Contains the text for the generated policy and its details.
      struct GeneratedPolicyResult
        include JSON::Serializable

        # A GeneratedPolicyProperties object that contains properties of the generated policy.
        @[JSON::Field(key: "properties")]
        getter properties : Types::GeneratedPolicyProperties

        # The text to use as the content for the new policy. The policy is created using the CreatePolicy
        # action.
        @[JSON::Field(key: "generatedPolicies")]
        getter generated_policies : Array(Types::GeneratedPolicy)?

        def initialize(
          @properties : Types::GeneratedPolicyProperties,
          @generated_policies : Array(Types::GeneratedPolicy)? = nil
        )
        end
      end

      struct GetAccessPreviewRequest
        include JSON::Serializable

        # The unique ID for the access preview.
        @[JSON::Field(key: "accessPreviewId")]
        getter access_preview_id : String

        # The ARN of the analyzer used to generate the access preview.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        def initialize(
          @access_preview_id : String,
          @analyzer_arn : String
        )
        end
      end

      struct GetAccessPreviewResponse
        include JSON::Serializable

        # An object that contains information about the access preview.
        @[JSON::Field(key: "accessPreview")]
        getter access_preview : Types::AccessPreview

        def initialize(
          @access_preview : Types::AccessPreview
        )
        end
      end

      # Retrieves an analyzed resource.
      struct GetAnalyzedResourceRequest
        include JSON::Serializable

        # The ARN of the analyzer to retrieve information from.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The ARN of the resource to retrieve information about.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        def initialize(
          @analyzer_arn : String,
          @resource_arn : String
        )
        end
      end

      # The response to the request.
      struct GetAnalyzedResourceResponse
        include JSON::Serializable

        # An AnalyzedResource object that contains information that IAM Access Analyzer found when it analyzed
        # the resource.
        @[JSON::Field(key: "resource")]
        getter resource : Types::AnalyzedResource?

        def initialize(
          @resource : Types::AnalyzedResource? = nil
        )
        end
      end

      # Retrieves an analyzer.
      struct GetAnalyzerRequest
        include JSON::Serializable

        # The name of the analyzer retrieved.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        def initialize(
          @analyzer_name : String
        )
        end
      end

      # The response to the request.
      struct GetAnalyzerResponse
        include JSON::Serializable

        # An AnalyzerSummary object that contains information about the analyzer.
        @[JSON::Field(key: "analyzer")]
        getter analyzer : Types::AnalyzerSummary

        def initialize(
          @analyzer : Types::AnalyzerSummary
        )
        end
      end

      # Retrieves an archive rule.
      struct GetArchiveRuleRequest
        include JSON::Serializable

        # The name of the analyzer to retrieve rules from.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # The name of the rule to retrieve.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        def initialize(
          @analyzer_name : String,
          @rule_name : String
        )
        end
      end

      # The response to the request.
      struct GetArchiveRuleResponse
        include JSON::Serializable

        @[JSON::Field(key: "archiveRule")]
        getter archive_rule : Types::ArchiveRuleSummary

        def initialize(
          @archive_rule : Types::ArchiveRuleSummary
        )
        end
      end

      struct GetFindingRecommendationRequest
        include JSON::Serializable

        # The ARN of the analyzer used to generate the finding recommendation.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The unique ID for the finding recommendation.
        @[JSON::Field(key: "id")]
        getter id : String

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @analyzer_arn : String,
          @id : String,
          @max_results : Int32? = nil,
          @next_token : String? = nil
        )
        end
      end

      struct GetFindingRecommendationResponse
        include JSON::Serializable

        # The type of recommendation for the finding.
        @[JSON::Field(key: "recommendationType")]
        getter recommendation_type : String

        # The ARN of the resource of the finding.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        # The time at which the retrieval of the finding recommendation was started.
        @[JSON::Field(key: "startedAt")]
        getter started_at : Time

        # The status of the retrieval of the finding recommendation.
        @[JSON::Field(key: "status")]
        getter status : String

        # The time at which the retrieval of the finding recommendation was completed.
        @[JSON::Field(key: "completedAt")]
        getter completed_at : Time?

        # Detailed information about the reason that the retrieval of a recommendation for the finding failed.
        @[JSON::Field(key: "error")]
        getter error : Types::RecommendationError?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # A group of recommended steps for the finding.
        @[JSON::Field(key: "recommendedSteps")]
        getter recommended_steps : Array(Types::RecommendedStep)?

        def initialize(
          @recommendation_type : String,
          @resource_arn : String,
          @started_at : Time,
          @status : String,
          @completed_at : Time? = nil,
          @error : Types::RecommendationError? = nil,
          @next_token : String? = nil,
          @recommended_steps : Array(Types::RecommendedStep)? = nil
        )
        end
      end

      # Retrieves a finding.
      struct GetFindingRequest
        include JSON::Serializable

        # The ARN of the analyzer that generated the finding.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The ID of the finding to retrieve.
        @[JSON::Field(key: "id")]
        getter id : String

        def initialize(
          @analyzer_arn : String,
          @id : String
        )
        end
      end

      # The response to the request.
      struct GetFindingResponse
        include JSON::Serializable

        # A finding object that contains finding details.
        @[JSON::Field(key: "finding")]
        getter finding : Types::Finding?

        def initialize(
          @finding : Types::Finding? = nil
        )
        end
      end

      struct GetFindingV2Request
        include JSON::Serializable

        # The ARN of the analyzer that generated the finding.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The ID of the finding to retrieve.
        @[JSON::Field(key: "id")]
        getter id : String

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @analyzer_arn : String,
          @id : String,
          @max_results : Int32? = nil,
          @next_token : String? = nil
        )
        end
      end

      struct GetFindingV2Response
        include JSON::Serializable

        # The time at which the resource-based policy or IAM entity that generated the finding was analyzed.
        @[JSON::Field(key: "analyzedAt")]
        getter analyzed_at : Time

        # The time at which the finding was created.
        @[JSON::Field(key: "createdAt")]
        getter created_at : Time

        # A localized message that explains the finding and provides guidance on how to address it.
        @[JSON::Field(key: "findingDetails")]
        getter finding_details : Array(Types::FindingDetails)

        # The ID of the finding to retrieve.
        @[JSON::Field(key: "id")]
        getter id : String

        # Tye Amazon Web Services account ID that owns the resource.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String

        # The type of the resource identified in the finding.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        # The status of the finding.
        @[JSON::Field(key: "status")]
        getter status : String

        # The time at which the finding was updated.
        @[JSON::Field(key: "updatedAt")]
        getter updated_at : Time

        # An error.
        @[JSON::Field(key: "error")]
        getter error : String?

        # The type of the finding. For external access analyzers, the type is ExternalAccess . For unused
        # access analyzers, the type can be UnusedIAMRole , UnusedIAMUserAccessKey , UnusedIAMUserPassword ,
        # or UnusedPermission . For internal access analyzers, the type is InternalAccess .
        @[JSON::Field(key: "findingType")]
        getter finding_type : String?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # The resource that generated the finding.
        @[JSON::Field(key: "resource")]
        getter resource : String?

        def initialize(
          @analyzed_at : Time,
          @created_at : Time,
          @finding_details : Array(Types::FindingDetails),
          @id : String,
          @resource_owner_account : String,
          @resource_type : String,
          @status : String,
          @updated_at : Time,
          @error : String? = nil,
          @finding_type : String? = nil,
          @next_token : String? = nil,
          @resource : String? = nil
        )
        end
      end

      struct GetFindingsStatisticsRequest
        include JSON::Serializable

        # The ARN of the analyzer used to generate the statistics.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        def initialize(
          @analyzer_arn : String
        )
        end
      end

      struct GetFindingsStatisticsResponse
        include JSON::Serializable

        # A group of external access or unused access findings statistics.
        @[JSON::Field(key: "findingsStatistics")]
        getter findings_statistics : Array(Types::FindingsStatistics)?

        # The time at which the retrieval of the findings statistics was last updated. If the findings
        # statistics have not been previously retrieved for the specified analyzer, this field will not be
        # populated.
        @[JSON::Field(key: "lastUpdatedAt")]
        getter last_updated_at : Time?

        def initialize(
          @findings_statistics : Array(Types::FindingsStatistics)? = nil,
          @last_updated_at : Time? = nil
        )
        end
      end

      struct GetGeneratedPolicyRequest
        include JSON::Serializable

        # The JobId that is returned by the StartPolicyGeneration operation. The JobId can be used with
        # GetGeneratedPolicy to retrieve the generated policies or used with CancelPolicyGeneration to cancel
        # the policy generation request.
        @[JSON::Field(key: "jobId")]
        getter job_id : String

        # The level of detail that you want to generate. You can specify whether to generate policies with
        # placeholders for resource ARNs for actions that support resource level granularity in policies. For
        # example, in the resource section of a policy, you can receive a placeholder such as
        # "Resource":"arn:aws:s3:::${BucketName}" instead of "*" .
        @[JSON::Field(key: "includeResourcePlaceholders")]
        getter include_resource_placeholders : Bool?

        # The level of detail that you want to generate. You can specify whether to generate service-level
        # policies. IAM Access Analyzer uses iam:servicelastaccessed to identify services that have been used
        # recently to create this service-level template.
        @[JSON::Field(key: "includeServiceLevelTemplate")]
        getter include_service_level_template : Bool?

        def initialize(
          @job_id : String,
          @include_resource_placeholders : Bool? = nil,
          @include_service_level_template : Bool? = nil
        )
        end
      end

      struct GetGeneratedPolicyResponse
        include JSON::Serializable

        # A GeneratedPolicyResult object that contains the generated policies and associated details.
        @[JSON::Field(key: "generatedPolicyResult")]
        getter generated_policy_result : Types::GeneratedPolicyResult

        # A GeneratedPolicyDetails object that contains details about the generated policy.
        @[JSON::Field(key: "jobDetails")]
        getter job_details : Types::JobDetails

        def initialize(
          @generated_policy_result : Types::GeneratedPolicyResult,
          @job_details : Types::JobDetails
        )
        end
      end

      # The proposed access control configuration for an IAM role. You can propose a configuration for a new
      # IAM role or an existing IAM role that you own by specifying the trust policy. If the configuration
      # is for a new IAM role, you must specify the trust policy. If the configuration is for an existing
      # IAM role that you own and you do not propose the trust policy, the access preview uses the existing
      # trust policy for the role. The proposed trust policy cannot be an empty string. For more information
      # about role trust policy limits, see IAM and STS quotas .
      struct IamRoleConfiguration
        include JSON::Serializable

        # The proposed trust policy for the IAM role.
        @[JSON::Field(key: "trustPolicy")]
        getter trust_policy : String?

        def initialize(
          @trust_policy : String? = nil
        )
        end
      end

      # An criterion statement in an archive rule. Each archive rule may have multiple criteria.
      struct InlineArchiveRule
        include JSON::Serializable

        # The condition and values for a criterion.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)

        # The name of the rule.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        def initialize(
          @filter : Hash(String, Types::Criterion),
          @rule_name : String
        )
        end
      end

      # Contains information about analysis rules for the internal access analyzer. Analysis rules determine
      # which entities will generate findings based on the criteria you define when you create the rule.
      struct InternalAccessAnalysisRule
        include JSON::Serializable

        # A list of rules for the internal access analyzer containing criteria to include in analysis. Only
        # resources that meet the rule criteria will generate findings.
        @[JSON::Field(key: "inclusions")]
        getter inclusions : Array(Types::InternalAccessAnalysisRuleCriteria)?

        def initialize(
          @inclusions : Array(Types::InternalAccessAnalysisRuleCriteria)? = nil
        )
        end
      end

      # The criteria for an analysis rule for an internal access analyzer.
      struct InternalAccessAnalysisRuleCriteria
        include JSON::Serializable

        # A list of Amazon Web Services account IDs to apply to the internal access analysis rule criteria.
        # Account IDs can only be applied to the analysis rule criteria for organization-level analyzers.
        @[JSON::Field(key: "accountIds")]
        getter account_ids : Array(String)?

        # A list of resource ARNs to apply to the internal access analysis rule criteria. The analyzer will
        # only generate findings for resources that match these ARNs.
        @[JSON::Field(key: "resourceArns")]
        getter resource_arns : Array(String)?

        # A list of resource types to apply to the internal access analysis rule criteria. The analyzer will
        # only generate findings for resources of these types. These resource types are currently supported
        # for internal access analyzers: AWS::S3::Bucket AWS::RDS::DBSnapshot AWS::RDS::DBClusterSnapshot
        # AWS::S3Express::DirectoryBucket AWS::DynamoDB::Table AWS::DynamoDB::Stream
        @[JSON::Field(key: "resourceTypes")]
        getter resource_types : Array(String)?

        def initialize(
          @account_ids : Array(String)? = nil,
          @resource_arns : Array(String)? = nil,
          @resource_types : Array(String)? = nil
        )
        end
      end

      # Specifies the configuration of an internal access analyzer for an Amazon Web Services organization
      # or account. This configuration determines how the analyzer evaluates internal access within your
      # Amazon Web Services environment.
      struct InternalAccessConfiguration
        include JSON::Serializable

        # Contains information about analysis rules for the internal access analyzer. These rules determine
        # which resources and access patterns will be analyzed.
        @[JSON::Field(key: "analysisRule")]
        getter analysis_rule : Types::InternalAccessAnalysisRule?

        def initialize(
          @analysis_rule : Types::InternalAccessAnalysisRule? = nil
        )
        end
      end

      # Contains information about an internal access finding. This includes details about the access that
      # was identified within your Amazon Web Services organization or account.
      struct InternalAccessDetails
        include JSON::Serializable

        # The type of internal access identified in the finding. This indicates how the access is granted
        # within your Amazon Web Services environment.
        @[JSON::Field(key: "accessType")]
        getter access_type : String?

        # The action in the analyzed policy statement that has internal access permission to use.
        @[JSON::Field(key: "action")]
        getter action : Array(String)?

        # The condition in the analyzed policy statement that resulted in an internal access finding.
        @[JSON::Field(key: "condition")]
        getter condition : Hash(String, String)?

        # The principal that has access to a resource within the internal environment.
        @[JSON::Field(key: "principal")]
        getter principal : Hash(String, String)?

        # The Amazon Web Services account ID that owns the principal identified in the internal access
        # finding.
        @[JSON::Field(key: "principalOwnerAccount")]
        getter principal_owner_account : String?

        # The type of principal identified in the internal access finding, such as IAM role or IAM user.
        @[JSON::Field(key: "principalType")]
        getter principal_type : String?

        # The type of restriction applied to the finding by the resource owner with an Organizations resource
        # control policy (RCP). APPLICABLE : There is an RCP present in the organization but IAM Access
        # Analyzer does not include it in the evaluation of effective permissions. For example, if
        # s3:DeleteObject is blocked by the RCP and the restriction is APPLICABLE , then s3:DeleteObject would
        # still be included in the list of actions for the finding. Only applicable to internal access
        # findings with the account as the zone of trust. FAILED_TO_EVALUATE_RCP : There was an error
        # evaluating the RCP. NOT_APPLICABLE : There was no RCP present in the organization. For internal
        # access findings with the account as the zone of trust, NOT_APPLICABLE could also indicate that there
        # was no RCP applicable to the resource. APPLIED : An RCP is present in the organization and IAM
        # Access Analyzer included it in the evaluation of effective permissions. For example, if
        # s3:DeleteObject is blocked by the RCP and the restriction is APPLIED , then s3:DeleteObject would
        # not be included in the list of actions for the finding. Only applicable to internal access findings
        # with the organization as the zone of trust.
        @[JSON::Field(key: "resourceControlPolicyRestriction")]
        getter resource_control_policy_restriction : String?

        # The type of restriction applied to the finding by an Organizations service control policy (SCP).
        # APPLICABLE : There is an SCP present in the organization but IAM Access Analyzer does not include it
        # in the evaluation of effective permissions. Only applicable to internal access findings with the
        # account as the zone of trust. FAILED_TO_EVALUATE_SCP : There was an error evaluating the SCP.
        # NOT_APPLICABLE : There was no SCP present in the organization. For internal access findings with the
        # account as the zone of trust, NOT_APPLICABLE could also indicate that there was no SCP applicable to
        # the principal. APPLIED : An SCP is present in the organization and IAM Access Analyzer included it
        # in the evaluation of effective permissions. Only applicable to internal access findings with the
        # organization as the zone of trust.
        @[JSON::Field(key: "serviceControlPolicyRestriction")]
        getter service_control_policy_restriction : String?

        # The sources of the internal access finding. This indicates how the access that generated the finding
        # is granted within your Amazon Web Services environment.
        @[JSON::Field(key: "sources")]
        getter sources : Array(Types::FindingSource)?

        def initialize(
          @access_type : String? = nil,
          @action : Array(String)? = nil,
          @condition : Hash(String, String)? = nil,
          @principal : Hash(String, String)? = nil,
          @principal_owner_account : String? = nil,
          @principal_type : String? = nil,
          @resource_control_policy_restriction : String? = nil,
          @service_control_policy_restriction : String? = nil,
          @sources : Array(Types::FindingSource)? = nil
        )
        end
      end

      # Provides aggregate statistics about the findings for the specified internal access analyzer. This
      # includes counts of active, archived, and resolved findings.
      struct InternalAccessFindingsStatistics
        include JSON::Serializable

        # The total number of active findings for each resource type of the specified internal access
        # analyzer.
        @[JSON::Field(key: "resourceTypeStatistics")]
        getter resource_type_statistics : Hash(String, Types::InternalAccessResourceTypeDetails)?

        # The number of active findings for the specified internal access analyzer.
        @[JSON::Field(key: "totalActiveFindings")]
        getter total_active_findings : Int32?

        # The number of archived findings for the specified internal access analyzer.
        @[JSON::Field(key: "totalArchivedFindings")]
        getter total_archived_findings : Int32?

        # The number of resolved findings for the specified internal access analyzer.
        @[JSON::Field(key: "totalResolvedFindings")]
        getter total_resolved_findings : Int32?

        def initialize(
          @resource_type_statistics : Hash(String, Types::InternalAccessResourceTypeDetails)? = nil,
          @total_active_findings : Int32? = nil,
          @total_archived_findings : Int32? = nil,
          @total_resolved_findings : Int32? = nil
        )
        end
      end

      # Contains information about the total number of active, archived, and resolved findings for a
      # resource type of an internal access analyzer.
      struct InternalAccessResourceTypeDetails
        include JSON::Serializable

        # The total number of active findings for the resource type in the internal access analyzer.
        @[JSON::Field(key: "totalActiveFindings")]
        getter total_active_findings : Int32?

        # The total number of archived findings for the resource type in the internal access analyzer.
        @[JSON::Field(key: "totalArchivedFindings")]
        getter total_archived_findings : Int32?

        # The total number of resolved findings for the resource type in the internal access analyzer.
        @[JSON::Field(key: "totalResolvedFindings")]
        getter total_resolved_findings : Int32?

        def initialize(
          @total_active_findings : Int32? = nil,
          @total_archived_findings : Int32? = nil,
          @total_resolved_findings : Int32? = nil
        )
        end
      end

      # Internal server error.
      struct InternalServerException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        # The seconds to wait to retry.
        @[JSON::Field(key: "Retry-After")]
        getter retry_after_seconds : Int32?

        def initialize(
          @message : String,
          @retry_after_seconds : Int32? = nil
        )
        end
      end

      # This configuration sets the network origin for the Amazon S3 access point or multi-region access
      # point to Internet .
      struct InternetConfiguration
        include JSON::Serializable

        def initialize
        end
      end

      # The specified parameter is invalid.
      struct InvalidParameterException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        def initialize(
          @message : String
        )
        end
      end

      # Contains details about the policy generation request.
      struct JobDetails
        include JSON::Serializable

        # The JobId that is returned by the StartPolicyGeneration operation. The JobId can be used with
        # GetGeneratedPolicy to retrieve the generated policies or used with CancelPolicyGeneration to cancel
        # the policy generation request.
        @[JSON::Field(key: "jobId")]
        getter job_id : String

        # A timestamp of when the job was started.
        @[JSON::Field(key: "startedOn")]
        getter started_on : Time

        # The status of the job request.
        @[JSON::Field(key: "status")]
        getter status : String

        # A timestamp of when the job was completed.
        @[JSON::Field(key: "completedOn")]
        getter completed_on : Time?

        # The job error for the policy generation request.
        @[JSON::Field(key: "jobError")]
        getter job_error : Types::JobError?

        def initialize(
          @job_id : String,
          @started_on : Time,
          @status : String,
          @completed_on : Time? = nil,
          @job_error : Types::JobError? = nil
        )
        end
      end

      # Contains the details about the policy generation error.
      struct JobError
        include JSON::Serializable

        # The job error code.
        @[JSON::Field(key: "code")]
        getter code : String

        # Specific information about the error. For example, which service quota was exceeded or which
        # resource was not found.
        @[JSON::Field(key: "message")]
        getter message : String

        def initialize(
          @code : String,
          @message : String
        )
        end
      end

      # A proposed grant configuration for a KMS key. For more information, see CreateGrant .
      struct KmsGrantConfiguration
        include JSON::Serializable

        # The principal that is given permission to perform the operations that the grant permits.
        @[JSON::Field(key: "granteePrincipal")]
        getter grantee_principal : String

        # The Amazon Web Services account under which the grant was issued. The account is used to propose KMS
        # grants issued by accounts other than the owner of the key.
        @[JSON::Field(key: "issuingAccount")]
        getter issuing_account : String

        # A list of operations that the grant permits.
        @[JSON::Field(key: "operations")]
        getter operations : Array(String)

        # Use this structure to propose allowing cryptographic operations in the grant only when the operation
        # request includes the specified encryption context .
        @[JSON::Field(key: "constraints")]
        getter constraints : Types::KmsGrantConstraints?

        # The principal that is given permission to retire the grant by using RetireGrant operation.
        @[JSON::Field(key: "retiringPrincipal")]
        getter retiring_principal : String?

        def initialize(
          @grantee_principal : String,
          @issuing_account : String,
          @operations : Array(String),
          @constraints : Types::KmsGrantConstraints? = nil,
          @retiring_principal : String? = nil
        )
        end
      end

      # Use this structure to propose allowing cryptographic operations in the grant only when the operation
      # request includes the specified encryption context . You can specify only one type of encryption
      # context. An empty map is treated as not specified. For more information, see GrantConstraints .
      struct KmsGrantConstraints
        include JSON::Serializable

        # A list of key-value pairs that must match the encryption context in the cryptographic operation
        # request. The grant allows the operation only when the encryption context in the request is the same
        # as the encryption context specified in this constraint.
        @[JSON::Field(key: "encryptionContextEquals")]
        getter encryption_context_equals : Hash(String, String)?

        # A list of key-value pairs that must be included in the encryption context of the cryptographic
        # operation request. The grant allows the cryptographic operation only when the encryption context in
        # the request includes the key-value pairs specified in this constraint, although it can include
        # additional key-value pairs.
        @[JSON::Field(key: "encryptionContextSubset")]
        getter encryption_context_subset : Hash(String, String)?

        def initialize(
          @encryption_context_equals : Hash(String, String)? = nil,
          @encryption_context_subset : Hash(String, String)? = nil
        )
        end
      end

      # Proposed access control configuration for a KMS key. You can propose a configuration for a new KMS
      # key or an existing KMS key that you own by specifying the key policy and KMS grant configuration. If
      # the configuration is for an existing key and you do not specify the key policy, the access preview
      # uses the existing policy for the key. If the access preview is for a new resource and you do not
      # specify the key policy, then the access preview uses the default key policy. The proposed key policy
      # cannot be an empty string. For more information, see Default key policy . For more information about
      # key policy limits, see Resource quotas .
      struct KmsKeyConfiguration
        include JSON::Serializable

        # A list of proposed grant configurations for the KMS key. If the proposed grant configuration is for
        # an existing key, the access preview uses the proposed list of grant configurations in place of the
        # existing grants. Otherwise, the access preview uses the existing grants for the key.
        @[JSON::Field(key: "grants")]
        getter grants : Array(Types::KmsGrantConfiguration)?

        # Resource policy configuration for the KMS key. The only valid value for the name of the key policy
        # is default . For more information, see Default key policy .
        @[JSON::Field(key: "keyPolicies")]
        getter key_policies : Hash(String, String)?

        def initialize(
          @grants : Array(Types::KmsGrantConfiguration)? = nil,
          @key_policies : Hash(String, String)? = nil
        )
        end
      end

      struct ListAccessPreviewFindingsRequest
        include JSON::Serializable

        # The unique ID for the access preview.
        @[JSON::Field(key: "accessPreviewId")]
        getter access_preview_id : String

        # The ARN of the analyzer used to generate the access.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # Criteria to filter the returned findings.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)?

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @access_preview_id : String,
          @analyzer_arn : String,
          @filter : Hash(String, Types::Criterion)? = nil,
          @max_results : Int32? = nil,
          @next_token : String? = nil
        )
        end
      end

      struct ListAccessPreviewFindingsResponse
        include JSON::Serializable

        # A list of access preview findings that match the specified filter criteria.
        @[JSON::Field(key: "findings")]
        getter findings : Array(Types::AccessPreviewFinding)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @findings : Array(Types::AccessPreviewFinding),
          @next_token : String? = nil
        )
        end
      end

      struct ListAccessPreviewsRequest
        include JSON::Serializable

        # The ARN of the analyzer used to generate the access preview.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @analyzer_arn : String,
          @max_results : Int32? = nil,
          @next_token : String? = nil
        )
        end
      end

      struct ListAccessPreviewsResponse
        include JSON::Serializable

        # A list of access previews retrieved for the analyzer.
        @[JSON::Field(key: "accessPreviews")]
        getter access_previews : Array(Types::AccessPreviewSummary)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @access_previews : Array(Types::AccessPreviewSummary),
          @next_token : String? = nil
        )
        end
      end

      # Retrieves a list of resources that have been analyzed.
      struct ListAnalyzedResourcesRequest
        include JSON::Serializable

        # The ARN of the analyzer to retrieve a list of analyzed resources from.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # The type of resource.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String?

        def initialize(
          @analyzer_arn : String,
          @max_results : Int32? = nil,
          @next_token : String? = nil,
          @resource_type : String? = nil
        )
        end
      end

      # The response to the request.
      struct ListAnalyzedResourcesResponse
        include JSON::Serializable

        # A list of resources that were analyzed.
        @[JSON::Field(key: "analyzedResources")]
        getter analyzed_resources : Array(Types::AnalyzedResourceSummary)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @analyzed_resources : Array(Types::AnalyzedResourceSummary),
          @next_token : String? = nil
        )
        end
      end

      # Retrieves a list of analyzers.
      struct ListAnalyzersRequest
        include JSON::Serializable

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # The type of analyzer.
        @[JSON::Field(key: "type")]
        getter type : String?

        def initialize(
          @max_results : Int32? = nil,
          @next_token : String? = nil,
          @type : String? = nil
        )
        end
      end

      # The response to the request.
      struct ListAnalyzersResponse
        include JSON::Serializable

        # The analyzers retrieved.
        @[JSON::Field(key: "analyzers")]
        getter analyzers : Array(Types::AnalyzerSummary)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @analyzers : Array(Types::AnalyzerSummary),
          @next_token : String? = nil
        )
        end
      end

      # Retrieves a list of archive rules created for the specified analyzer.
      struct ListArchiveRulesRequest
        include JSON::Serializable

        # The name of the analyzer to retrieve rules from.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # The maximum number of results to return in the request.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @analyzer_name : String,
          @max_results : Int32? = nil,
          @next_token : String? = nil
        )
        end
      end

      # The response to the request.
      struct ListArchiveRulesResponse
        include JSON::Serializable

        # A list of archive rules created for the specified analyzer.
        @[JSON::Field(key: "archiveRules")]
        getter archive_rules : Array(Types::ArchiveRuleSummary)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @archive_rules : Array(Types::ArchiveRuleSummary),
          @next_token : String? = nil
        )
        end
      end

      # Retrieves a list of findings generated by the specified analyzer.
      struct ListFindingsRequest
        include JSON::Serializable

        # The ARN of the analyzer to retrieve findings from.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # A filter to match for the findings to return.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)?

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # The sort order for the findings returned.
        @[JSON::Field(key: "sort")]
        getter sort : Types::SortCriteria?

        def initialize(
          @analyzer_arn : String,
          @filter : Hash(String, Types::Criterion)? = nil,
          @max_results : Int32? = nil,
          @next_token : String? = nil,
          @sort : Types::SortCriteria? = nil
        )
        end
      end

      # The response to the request.
      struct ListFindingsResponse
        include JSON::Serializable

        # A list of findings retrieved from the analyzer that match the filter criteria specified, if any.
        @[JSON::Field(key: "findings")]
        getter findings : Array(Types::FindingSummary)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @findings : Array(Types::FindingSummary),
          @next_token : String? = nil
        )
        end
      end

      struct ListFindingsV2Request
        include JSON::Serializable

        # The ARN of the analyzer to retrieve findings from.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # A filter to match for the findings to return.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)?

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        @[JSON::Field(key: "sort")]
        getter sort : Types::SortCriteria?

        def initialize(
          @analyzer_arn : String,
          @filter : Hash(String, Types::Criterion)? = nil,
          @max_results : Int32? = nil,
          @next_token : String? = nil,
          @sort : Types::SortCriteria? = nil
        )
        end
      end

      struct ListFindingsV2Response
        include JSON::Serializable

        # A list of findings retrieved from the analyzer that match the filter criteria specified, if any.
        @[JSON::Field(key: "findings")]
        getter findings : Array(Types::FindingSummaryV2)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @findings : Array(Types::FindingSummaryV2),
          @next_token : String? = nil
        )
        end
      end

      struct ListPolicyGenerationsRequest
        include JSON::Serializable

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # The ARN of the IAM entity (user or role) for which you are generating a policy. Use this with
        # ListGeneratedPolicies to filter the results to only include results for a specific principal.
        @[JSON::Field(key: "principalArn")]
        getter principal_arn : String?

        def initialize(
          @max_results : Int32? = nil,
          @next_token : String? = nil,
          @principal_arn : String? = nil
        )
        end
      end

      struct ListPolicyGenerationsResponse
        include JSON::Serializable

        # A PolicyGeneration object that contains details about the generated policy.
        @[JSON::Field(key: "policyGenerations")]
        getter policy_generations : Array(Types::PolicyGeneration)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @policy_generations : Array(Types::PolicyGeneration),
          @next_token : String? = nil
        )
        end
      end

      # Retrieves a list of tags applied to the specified resource.
      struct ListTagsForResourceRequest
        include JSON::Serializable

        # The ARN of the resource to retrieve tags from.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        def initialize(
          @resource_arn : String
        )
        end
      end

      # The response to the request.
      struct ListTagsForResourceResponse
        include JSON::Serializable

        # The tags that are applied to the specified resource.
        @[JSON::Field(key: "tags")]
        getter tags : Hash(String, String)?

        def initialize(
          @tags : Hash(String, String)? = nil
        )
        end
      end

      # A location in a policy that is represented as a path through the JSON representation and a
      # corresponding span.
      struct Location
        include JSON::Serializable

        # A path in a policy, represented as a sequence of path elements.
        @[JSON::Field(key: "path")]
        getter path : Array(Types::PathElement)

        # A span in a policy.
        @[JSON::Field(key: "span")]
        getter span : Types::Span

        def initialize(
          @path : Array(Types::PathElement),
          @span : Types::Span
        )
        end
      end

      # The proposed InternetConfiguration or VpcConfiguration to apply to the Amazon S3 access point. You
      # can make the access point accessible from the internet, or you can specify that all requests made
      # through that access point must originate from a specific virtual private cloud (VPC). You can
      # specify only one type of network configuration. For more information, see Creating access points .
      struct NetworkOriginConfiguration
        include JSON::Serializable

        # The configuration for the Amazon S3 access point or multi-region access point with an Internet
        # origin.
        @[JSON::Field(key: "internetConfiguration")]
        getter internet_configuration : Types::InternetConfiguration?

        @[JSON::Field(key: "vpcConfiguration")]
        getter vpc_configuration : Types::VpcConfiguration?

        def initialize(
          @internet_configuration : Types::InternetConfiguration? = nil,
          @vpc_configuration : Types::VpcConfiguration? = nil
        )
        end
      end

      # A single element in a path through the JSON representation of a policy.
      struct PathElement
        include JSON::Serializable

        # Refers to an index in a JSON array.
        @[JSON::Field(key: "index")]
        getter index : Int32?

        # Refers to a key in a JSON object.
        @[JSON::Field(key: "key")]
        getter key : String?

        # Refers to a substring of a literal string in a JSON object.
        @[JSON::Field(key: "substring")]
        getter substring : Types::Substring?

        # Refers to the value associated with a given key in a JSON object.
        @[JSON::Field(key: "value")]
        getter value : String?

        def initialize(
          @index : Int32? = nil,
          @key : String? = nil,
          @substring : Types::Substring? = nil,
          @value : String? = nil
        )
        end
      end

      # Contains details about the policy generation status and properties.
      struct PolicyGeneration
        include JSON::Serializable

        # The JobId that is returned by the StartPolicyGeneration operation. The JobId can be used with
        # GetGeneratedPolicy to retrieve the generated policies or used with CancelPolicyGeneration to cancel
        # the policy generation request.
        @[JSON::Field(key: "jobId")]
        getter job_id : String

        # The ARN of the IAM entity (user or role) for which you are generating a policy.
        @[JSON::Field(key: "principalArn")]
        getter principal_arn : String

        # A timestamp of when the policy generation started.
        @[JSON::Field(key: "startedOn")]
        getter started_on : Time

        # The status of the policy generation request.
        @[JSON::Field(key: "status")]
        getter status : String

        # A timestamp of when the policy generation was completed.
        @[JSON::Field(key: "completedOn")]
        getter completed_on : Time?

        def initialize(
          @job_id : String,
          @principal_arn : String,
          @started_on : Time,
          @status : String,
          @completed_on : Time? = nil
        )
        end
      end

      # Contains the ARN details about the IAM entity for which the policy is generated.
      struct PolicyGenerationDetails
        include JSON::Serializable

        # The ARN of the IAM entity (user or role) for which you are generating a policy.
        @[JSON::Field(key: "principalArn")]
        getter principal_arn : String

        def initialize(
          @principal_arn : String
        )
        end
      end

      # A position in a policy.
      struct Position
        include JSON::Serializable

        # The column of the position, starting from 0.
        @[JSON::Field(key: "column")]
        getter column : Int32

        # The line of the position, starting from 1.
        @[JSON::Field(key: "line")]
        getter line : Int32

        # The offset within the policy that corresponds to the position, starting from 0.
        @[JSON::Field(key: "offset")]
        getter offset : Int32

        def initialize(
          @column : Int32,
          @line : Int32,
          @offset : Int32
        )
        end
      end

      # The values for a manual Amazon RDS DB cluster snapshot attribute.
      struct RdsDbClusterSnapshotAttributeValue
        include JSON::Serializable

        # The Amazon Web Services account IDs that have access to the manual Amazon RDS DB cluster snapshot.
        # If the value all is specified, then the Amazon RDS DB cluster snapshot is public and can be copied
        # or restored by all Amazon Web Services accounts. If the configuration is for an existing Amazon RDS
        # DB cluster snapshot and you do not specify the accountIds in RdsDbClusterSnapshotAttributeValue ,
        # then the access preview uses the existing shared accountIds for the snapshot. If the access preview
        # is for a new resource and you do not specify the specify the accountIds in
        # RdsDbClusterSnapshotAttributeValue , then the access preview considers the snapshot without any
        # attributes. To propose deletion of existing shared accountIds , you can specify an empty list for
        # accountIds in the RdsDbClusterSnapshotAttributeValue .
        @[JSON::Field(key: "accountIds")]
        getter account_ids : Array(String)?

        def initialize(
          @account_ids : Array(String)? = nil
        )
        end
      end

      # The proposed access control configuration for an Amazon RDS DB cluster snapshot. You can propose a
      # configuration for a new Amazon RDS DB cluster snapshot or an Amazon RDS DB cluster snapshot that you
      # own by specifying the RdsDbClusterSnapshotAttributeValue and optional KMS encryption key. For more
      # information, see ModifyDBClusterSnapshotAttribute .
      struct RdsDbClusterSnapshotConfiguration
        include JSON::Serializable

        # The names and values of manual DB cluster snapshot attributes. Manual DB cluster snapshot attributes
        # are used to authorize other Amazon Web Services accounts to restore a manual DB cluster snapshot.
        # The only valid value for AttributeName for the attribute map is restore
        @[JSON::Field(key: "attributes")]
        getter attributes : Hash(String, Types::RdsDbClusterSnapshotAttributeValue)?

        # The KMS key identifier for an encrypted Amazon RDS DB cluster snapshot. The KMS key identifier is
        # the key ARN, key ID, alias ARN, or alias name for the KMS key. If the configuration is for an
        # existing Amazon RDS DB cluster snapshot and you do not specify the kmsKeyId , or you specify an
        # empty string, then the access preview uses the existing kmsKeyId of the snapshot. If the access
        # preview is for a new resource and you do not specify the specify the kmsKeyId , then the access
        # preview considers the snapshot as unencrypted.
        @[JSON::Field(key: "kmsKeyId")]
        getter kms_key_id : String?

        def initialize(
          @attributes : Hash(String, Types::RdsDbClusterSnapshotAttributeValue)? = nil,
          @kms_key_id : String? = nil
        )
        end
      end

      # The name and values of a manual Amazon RDS DB snapshot attribute. Manual DB snapshot attributes are
      # used to authorize other Amazon Web Services accounts to restore a manual DB snapshot.
      struct RdsDbSnapshotAttributeValue
        include JSON::Serializable

        # The Amazon Web Services account IDs that have access to the manual Amazon RDS DB snapshot. If the
        # value all is specified, then the Amazon RDS DB snapshot is public and can be copied or restored by
        # all Amazon Web Services accounts. If the configuration is for an existing Amazon RDS DB snapshot and
        # you do not specify the accountIds in RdsDbSnapshotAttributeValue , then the access preview uses the
        # existing shared accountIds for the snapshot. If the access preview is for a new resource and you do
        # not specify the specify the accountIds in RdsDbSnapshotAttributeValue , then the access preview
        # considers the snapshot without any attributes. To propose deletion of an existing shared accountIds
        # , you can specify an empty list for accountIds in the RdsDbSnapshotAttributeValue .
        @[JSON::Field(key: "accountIds")]
        getter account_ids : Array(String)?

        def initialize(
          @account_ids : Array(String)? = nil
        )
        end
      end

      # The proposed access control configuration for an Amazon RDS DB snapshot. You can propose a
      # configuration for a new Amazon RDS DB snapshot or an Amazon RDS DB snapshot that you own by
      # specifying the RdsDbSnapshotAttributeValue and optional KMS encryption key. For more information,
      # see ModifyDBSnapshotAttribute .
      struct RdsDbSnapshotConfiguration
        include JSON::Serializable

        # The names and values of manual DB snapshot attributes. Manual DB snapshot attributes are used to
        # authorize other Amazon Web Services accounts to restore a manual DB snapshot. The only valid value
        # for attributeName for the attribute map is restore.
        @[JSON::Field(key: "attributes")]
        getter attributes : Hash(String, Types::RdsDbSnapshotAttributeValue)?

        # The KMS key identifier for an encrypted Amazon RDS DB snapshot. The KMS key identifier is the key
        # ARN, key ID, alias ARN, or alias name for the KMS key. If the configuration is for an existing
        # Amazon RDS DB snapshot and you do not specify the kmsKeyId , or you specify an empty string, then
        # the access preview uses the existing kmsKeyId of the snapshot. If the access preview is for a new
        # resource and you do not specify the specify the kmsKeyId , then the access preview considers the
        # snapshot as unencrypted.
        @[JSON::Field(key: "kmsKeyId")]
        getter kms_key_id : String?

        def initialize(
          @attributes : Hash(String, Types::RdsDbSnapshotAttributeValue)? = nil,
          @kms_key_id : String? = nil
        )
        end
      end

      # Contains information about the reasoning why a check for access passed or failed.
      struct ReasonSummary
        include JSON::Serializable

        # A description of the reasoning of a result of checking for access.
        @[JSON::Field(key: "description")]
        getter description : String?

        # The identifier for the reason statement.
        @[JSON::Field(key: "statementId")]
        getter statement_id : String?

        # The index number of the reason statement.
        @[JSON::Field(key: "statementIndex")]
        getter statement_index : Int32?

        def initialize(
          @description : String? = nil,
          @statement_id : String? = nil,
          @statement_index : Int32? = nil
        )
        end
      end

      # Contains information about the reason that the retrieval of a recommendation for a finding failed.
      struct RecommendationError
        include JSON::Serializable

        # The error code for a failed retrieval of a recommendation for a finding.
        @[JSON::Field(key: "code")]
        getter code : String

        # The error message for a failed retrieval of a recommendation for a finding.
        @[JSON::Field(key: "message")]
        getter message : String

        def initialize(
          @code : String,
          @message : String
        )
        end
      end

      # Contains information about a recommended step for an unused access analyzer finding.
      struct RecommendedStep
        include JSON::Serializable

        # A recommended step for an unused permissions finding.
        @[JSON::Field(key: "unusedPermissionsRecommendedStep")]
        getter unused_permissions_recommended_step : Types::UnusedPermissionsRecommendedStep?

        def initialize(
          @unused_permissions_recommended_step : Types::UnusedPermissionsRecommendedStep? = nil
        )
        end
      end

      # The specified resource could not be found.
      struct ResourceNotFoundException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        # The ID of the resource.
        @[JSON::Field(key: "resourceId")]
        getter resource_id : String

        # The type of the resource.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        def initialize(
          @message : String,
          @resource_id : String,
          @resource_type : String
        )
        end
      end

      # Contains information about the total number of active cross-account and public findings for a
      # resource type of an external access analyzer.
      struct ResourceTypeDetails
        include JSON::Serializable

        # The total number of active cross-account findings for the resource type.
        @[JSON::Field(key: "totalActiveCrossAccount")]
        getter total_active_cross_account : Int32?

        # The total number of active errors for the resource type.
        @[JSON::Field(key: "totalActiveErrors")]
        getter total_active_errors : Int32?

        # The total number of active public findings for the resource type.
        @[JSON::Field(key: "totalActivePublic")]
        getter total_active_public : Int32?

        def initialize(
          @total_active_cross_account : Int32? = nil,
          @total_active_errors : Int32? = nil,
          @total_active_public : Int32? = nil
        )
        end
      end

      # The configuration for an Amazon S3 access point or multi-region access point for the bucket. You can
      # propose up to 10 access points or multi-region access points per bucket. If the proposed Amazon S3
      # access point configuration is for an existing bucket, the access preview uses the proposed access
      # point configuration in place of the existing access points. To propose an access point without a
      # policy, you can provide an empty string as the access point policy. For more information, see
      # Creating access points . For more information about access point policy limits, see Access points
      # restrictions and limitations .
      struct S3AccessPointConfiguration
        include JSON::Serializable

        # The access point or multi-region access point policy.
        @[JSON::Field(key: "accessPointPolicy")]
        getter access_point_policy : String?

        # The proposed Internet and VpcConfiguration to apply to this Amazon S3 access point. VpcConfiguration
        # does not apply to multi-region access points. If the access preview is for a new resource and
        # neither is specified, the access preview uses Internet for the network origin. If the access preview
        # is for an existing resource and neither is specified, the access preview uses the existing network
        # origin.
        @[JSON::Field(key: "networkOrigin")]
        getter network_origin : Types::NetworkOriginConfiguration?

        # The proposed S3PublicAccessBlock configuration to apply to this Amazon S3 access point or
        # multi-region access point.
        @[JSON::Field(key: "publicAccessBlock")]
        getter public_access_block : Types::S3PublicAccessBlockConfiguration?

        def initialize(
          @access_point_policy : String? = nil,
          @network_origin : Types::NetworkOriginConfiguration? = nil,
          @public_access_block : Types::S3PublicAccessBlockConfiguration? = nil
        )
        end
      end

      # A proposed access control list grant configuration for an Amazon S3 bucket. For more information,
      # see How to Specify an ACL .
      struct S3BucketAclGrantConfiguration
        include JSON::Serializable

        # The grantee to whom youre assigning access rights.
        @[JSON::Field(key: "grantee")]
        getter grantee : Types::AclGrantee

        # The permissions being granted.
        @[JSON::Field(key: "permission")]
        getter permission : String

        def initialize(
          @grantee : Types::AclGrantee,
          @permission : String
        )
        end
      end

      # Proposed access control configuration for an Amazon S3 bucket. You can propose a configuration for a
      # new Amazon S3 bucket or an existing Amazon S3 bucket that you own by specifying the Amazon S3 bucket
      # policy, bucket ACLs, bucket BPA settings, Amazon S3 access points, and multi-region access points
      # attached to the bucket. If the configuration is for an existing Amazon S3 bucket and you do not
      # specify the Amazon S3 bucket policy, the access preview uses the existing policy attached to the
      # bucket. If the access preview is for a new resource and you do not specify the Amazon S3 bucket
      # policy, the access preview assumes a bucket without a policy. To propose deletion of an existing
      # bucket policy, you can specify an empty string. For more information about bucket policy limits, see
      # Bucket Policy Examples .
      struct S3BucketConfiguration
        include JSON::Serializable

        # The configuration of Amazon S3 access points or multi-region access points for the bucket. You can
        # propose up to 10 new access points per bucket.
        @[JSON::Field(key: "accessPoints")]
        getter access_points : Hash(String, Types::S3AccessPointConfiguration)?

        # The proposed list of ACL grants for the Amazon S3 bucket. You can propose up to 100 ACL grants per
        # bucket. If the proposed grant configuration is for an existing bucket, the access preview uses the
        # proposed list of grant configurations in place of the existing grants. Otherwise, the access preview
        # uses the existing grants for the bucket.
        @[JSON::Field(key: "bucketAclGrants")]
        getter bucket_acl_grants : Array(Types::S3BucketAclGrantConfiguration)?

        # The proposed bucket policy for the Amazon S3 bucket.
        @[JSON::Field(key: "bucketPolicy")]
        getter bucket_policy : String?

        # The proposed block public access configuration for the Amazon S3 bucket.
        @[JSON::Field(key: "bucketPublicAccessBlock")]
        getter bucket_public_access_block : Types::S3PublicAccessBlockConfiguration?

        def initialize(
          @access_points : Hash(String, Types::S3AccessPointConfiguration)? = nil,
          @bucket_acl_grants : Array(Types::S3BucketAclGrantConfiguration)? = nil,
          @bucket_policy : String? = nil,
          @bucket_public_access_block : Types::S3PublicAccessBlockConfiguration? = nil
        )
        end
      end

      # Proposed configuration for an access point attached to an Amazon S3 directory bucket. You can
      # propose up to 10 access points per bucket. If the proposed access point configuration is for an
      # existing Amazon S3 directory bucket, the access preview uses the proposed access point configuration
      # in place of the existing access points. To propose an access point without a policy, you can provide
      # an empty string as the access point policy. For more information about access points for Amazon S3
      # directory buckets, see Managing access to directory buckets with access points in the Amazon Simple
      # Storage Service User Guide.
      struct S3ExpressDirectoryAccessPointConfiguration
        include JSON::Serializable

        # The proposed access point policy for an Amazon S3 directory bucket access point.
        @[JSON::Field(key: "accessPointPolicy")]
        getter access_point_policy : String?

        @[JSON::Field(key: "networkOrigin")]
        getter network_origin : Types::NetworkOriginConfiguration?

        def initialize(
          @access_point_policy : String? = nil,
          @network_origin : Types::NetworkOriginConfiguration? = nil
        )
        end
      end

      # Proposed access control configuration for an Amazon S3 directory bucket. You can propose a
      # configuration for a new Amazon S3 directory bucket or an existing Amazon S3 directory bucket that
      # you own by specifying the Amazon S3 bucket policy. If the configuration is for an existing Amazon S3
      # directory bucket and you do not specify the Amazon S3 bucket policy, the access preview uses the
      # existing policy attached to the directory bucket. If the access preview is for a new resource and
      # you do not specify the Amazon S3 bucket policy, the access preview assumes an directory bucket
      # without a policy. To propose deletion of an existing bucket policy, you can specify an empty string.
      # For more information about Amazon S3 directory bucket policies, see Example bucket policies for
      # directory buckets in the Amazon Simple Storage Service User Guide.
      struct S3ExpressDirectoryBucketConfiguration
        include JSON::Serializable

        # The proposed access points for the Amazon S3 directory bucket.
        @[JSON::Field(key: "accessPoints")]
        getter access_points : Hash(String, Types::S3ExpressDirectoryAccessPointConfiguration)?

        # The proposed bucket policy for the Amazon S3 directory bucket.
        @[JSON::Field(key: "bucketPolicy")]
        getter bucket_policy : String?

        def initialize(
          @access_points : Hash(String, Types::S3ExpressDirectoryAccessPointConfiguration)? = nil,
          @bucket_policy : String? = nil
        )
        end
      end

      # The PublicAccessBlock configuration to apply to this Amazon S3 bucket. If the proposed configuration
      # is for an existing Amazon S3 bucket and the configuration is not specified, the access preview uses
      # the existing setting. If the proposed configuration is for a new bucket and the configuration is not
      # specified, the access preview uses false . If the proposed configuration is for a new access point
      # or multi-region access point and the access point BPA configuration is not specified, the access
      # preview uses true . For more information, see PublicAccessBlockConfiguration .
      struct S3PublicAccessBlockConfiguration
        include JSON::Serializable

        # Specifies whether Amazon S3 should ignore public ACLs for this bucket and objects in this bucket.
        @[JSON::Field(key: "ignorePublicAcls")]
        getter ignore_public_acls : Bool

        # Specifies whether Amazon S3 should restrict public bucket policies for this bucket.
        @[JSON::Field(key: "restrictPublicBuckets")]
        getter restrict_public_buckets : Bool

        def initialize(
          @ignore_public_acls : Bool,
          @restrict_public_buckets : Bool
        )
        end
      end

      # The configuration for a Secrets Manager secret. For more information, see CreateSecret . You can
      # propose a configuration for a new secret or an existing secret that you own by specifying the secret
      # policy and optional KMS encryption key. If the configuration is for an existing secret and you do
      # not specify the secret policy, the access preview uses the existing policy for the secret. If the
      # access preview is for a new resource and you do not specify the policy, the access preview assumes a
      # secret without a policy. To propose deletion of an existing policy, you can specify an empty string.
      # If the proposed configuration is for a new secret and you do not specify the KMS key ID, the access
      # preview uses the Amazon Web Services managed key aws/secretsmanager . If you specify an empty string
      # for the KMS key ID, the access preview uses the Amazon Web Services managed key of the Amazon Web
      # Services account. For more information about secret policy limits, see Quotas for Secrets Manager. .
      struct SecretsManagerSecretConfiguration
        include JSON::Serializable

        # The proposed ARN, key ID, or alias of the KMS key.
        @[JSON::Field(key: "kmsKeyId")]
        getter kms_key_id : String?

        # The proposed resource policy defining who can access or manage the secret.
        @[JSON::Field(key: "secretPolicy")]
        getter secret_policy : String?

        def initialize(
          @kms_key_id : String? = nil,
          @secret_policy : String? = nil
        )
        end
      end

      # Service quote met error.
      struct ServiceQuotaExceededException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        # The resource ID.
        @[JSON::Field(key: "resourceId")]
        getter resource_id : String

        # The resource type.
        @[JSON::Field(key: "resourceType")]
        getter resource_type : String

        def initialize(
          @message : String,
          @resource_id : String,
          @resource_type : String
        )
        end
      end

      # The proposed access control configuration for an Amazon SNS topic. You can propose a configuration
      # for a new Amazon SNS topic or an existing Amazon SNS topic that you own by specifying the policy. If
      # the configuration is for an existing Amazon SNS topic and you do not specify the Amazon SNS policy,
      # then the access preview uses the existing Amazon SNS policy for the topic. If the access preview is
      # for a new resource and you do not specify the policy, then the access preview assumes an Amazon SNS
      # topic without a policy. To propose deletion of an existing Amazon SNS topic policy, you can specify
      # an empty string for the Amazon SNS policy. For more information, see Topic .
      struct SnsTopicConfiguration
        include JSON::Serializable

        # The JSON policy text that defines who can access an Amazon SNS topic. For more information, see
        # Example cases for Amazon SNS access control in the Amazon SNS Developer Guide .
        @[JSON::Field(key: "topicPolicy")]
        getter topic_policy : String?

        def initialize(
          @topic_policy : String? = nil
        )
        end
      end

      # The criteria used to sort.
      struct SortCriteria
        include JSON::Serializable

        # The name of the attribute to sort on.
        @[JSON::Field(key: "attributeName")]
        getter attribute_name : String?

        # The sort order, ascending or descending.
        @[JSON::Field(key: "orderBy")]
        getter order_by : String?

        def initialize(
          @attribute_name : String? = nil,
          @order_by : String? = nil
        )
        end
      end

      # A span in a policy. The span consists of a start position (inclusive) and end position (exclusive).
      struct Span
        include JSON::Serializable

        # The end position of the span (exclusive).
        @[JSON::Field(key: "end")]
        getter end : Types::Position

        # The start position of the span (inclusive).
        @[JSON::Field(key: "start")]
        getter start : Types::Position

        def initialize(
          @end : Types::Position,
          @start : Types::Position
        )
        end
      end

      # The proposed access control configuration for an Amazon SQS queue. You can propose a configuration
      # for a new Amazon SQS queue or an existing Amazon SQS queue that you own by specifying the Amazon SQS
      # policy. If the configuration is for an existing Amazon SQS queue and you do not specify the Amazon
      # SQS policy, the access preview uses the existing Amazon SQS policy for the queue. If the access
      # preview is for a new resource and you do not specify the policy, the access preview assumes an
      # Amazon SQS queue without a policy. To propose deletion of an existing Amazon SQS queue policy, you
      # can specify an empty string for the Amazon SQS policy. For more information about Amazon SQS policy
      # limits, see Quotas related to policies .
      struct SqsQueueConfiguration
        include JSON::Serializable

        # The proposed resource policy for the Amazon SQS queue.
        @[JSON::Field(key: "queuePolicy")]
        getter queue_policy : String?

        def initialize(
          @queue_policy : String? = nil
        )
        end
      end

      struct StartPolicyGenerationRequest
        include JSON::Serializable

        # Contains the ARN of the IAM entity (user or role) for which you are generating a policy.
        @[JSON::Field(key: "policyGenerationDetails")]
        getter policy_generation_details : Types::PolicyGenerationDetails

        # A unique, case-sensitive identifier that you provide to ensure the idempotency of the request.
        # Idempotency ensures that an API request completes only once. With an idempotent request, if the
        # original request completes successfully, the subsequent retries with the same client token return
        # the result from the original successful request and they have no additional effect. If you do not
        # specify a client token, one is automatically generated by the Amazon Web Services SDK.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        # A CloudTrailDetails object that contains details about a Trail that you want to analyze to generate
        # policies.
        @[JSON::Field(key: "cloudTrailDetails")]
        getter cloud_trail_details : Types::CloudTrailDetails?

        def initialize(
          @policy_generation_details : Types::PolicyGenerationDetails,
          @client_token : String? = nil,
          @cloud_trail_details : Types::CloudTrailDetails? = nil
        )
        end
      end

      struct StartPolicyGenerationResponse
        include JSON::Serializable

        # The JobId that is returned by the StartPolicyGeneration operation. The JobId can be used with
        # GetGeneratedPolicy to retrieve the generated policies or used with CancelPolicyGeneration to cancel
        # the policy generation request.
        @[JSON::Field(key: "jobId")]
        getter job_id : String

        def initialize(
          @job_id : String
        )
        end
      end

      # Starts a scan of the policies applied to the specified resource.
      struct StartResourceScanRequest
        include JSON::Serializable

        # The ARN of the analyzer to use to scan the policies applied to the specified resource.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The ARN of the resource to scan.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        # The Amazon Web Services account ID that owns the resource. For most Amazon Web Services resources,
        # the owning account is the account in which the resource was created.
        @[JSON::Field(key: "resourceOwnerAccount")]
        getter resource_owner_account : String?

        def initialize(
          @analyzer_arn : String,
          @resource_arn : String,
          @resource_owner_account : String? = nil
        )
        end
      end

      # Provides more details about the current status of the analyzer. For example, if the creation for the
      # analyzer fails, a Failed status is returned. For an analyzer with organization as the type, this
      # failure can be due to an issue with creating the service-linked roles required in the member
      # accounts of the Amazon Web Services organization.
      struct StatusReason
        include JSON::Serializable

        # The reason code for the current status of the analyzer.
        @[JSON::Field(key: "code")]
        getter code : String

        def initialize(
          @code : String
        )
        end
      end

      # A reference to a substring of a literal string in a JSON document.
      struct Substring
        include JSON::Serializable

        # The length of the substring.
        @[JSON::Field(key: "length")]
        getter length : Int32

        # The start index of the substring, starting from 0.
        @[JSON::Field(key: "start")]
        getter start : Int32

        def initialize(
          @length : Int32,
          @start : Int32
        )
        end
      end

      # Adds a tag to the specified resource.
      struct TagResourceRequest
        include JSON::Serializable

        # The ARN of the resource to add the tag to.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        # The tags to add to the resource.
        @[JSON::Field(key: "tags")]
        getter tags : Hash(String, String)

        def initialize(
          @resource_arn : String,
          @tags : Hash(String, String)
        )
        end
      end

      # The response to the request.
      struct TagResourceResponse
        include JSON::Serializable

        def initialize
        end
      end

      # Throttling limit exceeded error.
      struct ThrottlingException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        # The seconds to wait to retry.
        @[JSON::Field(key: "Retry-After")]
        getter retry_after_seconds : Int32?

        def initialize(
          @message : String,
          @retry_after_seconds : Int32? = nil
        )
        end
      end

      # Contains details about the CloudTrail trail being analyzed to generate a policy.
      struct Trail
        include JSON::Serializable

        # Specifies the ARN of the trail. The format of a trail ARN is
        # arn:aws:cloudtrail:us-east-2:123456789012:trail/MyTrail .
        @[JSON::Field(key: "cloudTrailArn")]
        getter cloud_trail_arn : String

        # Possible values are true or false . If set to true , IAM Access Analyzer retrieves CloudTrail data
        # from all regions to analyze and generate a policy.
        @[JSON::Field(key: "allRegions")]
        getter all_regions : Bool?

        # A list of regions to get CloudTrail data from and analyze to generate a policy.
        @[JSON::Field(key: "regions")]
        getter regions : Array(String)?

        def initialize(
          @cloud_trail_arn : String,
          @all_regions : Bool? = nil,
          @regions : Array(String)? = nil
        )
        end
      end

      # Contains details about the CloudTrail trail being analyzed to generate a policy.
      struct TrailProperties
        include JSON::Serializable

        # Specifies the ARN of the trail. The format of a trail ARN is
        # arn:aws:cloudtrail:us-east-2:123456789012:trail/MyTrail .
        @[JSON::Field(key: "cloudTrailArn")]
        getter cloud_trail_arn : String

        # Possible values are true or false . If set to true , IAM Access Analyzer retrieves CloudTrail data
        # from all regions to analyze and generate a policy.
        @[JSON::Field(key: "allRegions")]
        getter all_regions : Bool?

        # A list of regions to get CloudTrail data from and analyze to generate a policy.
        @[JSON::Field(key: "regions")]
        getter regions : Array(String)?

        def initialize(
          @cloud_trail_arn : String,
          @all_regions : Bool? = nil,
          @regions : Array(String)? = nil
        )
        end
      end

      # The specified entity could not be processed.
      struct UnprocessableEntityException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        def initialize(
          @message : String
        )
        end
      end

      # Removes a tag from the specified resource.
      struct UntagResourceRequest
        include JSON::Serializable

        # The ARN of the resource to remove the tag from.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String

        # The key for the tag to add.
        @[JSON::Field(key: "tagKeys")]
        getter tag_keys : Array(String)

        def initialize(
          @resource_arn : String,
          @tag_keys : Array(String)
        )
        end
      end

      # The response to the request.
      struct UntagResourceResponse
        include JSON::Serializable

        def initialize
        end
      end

      # Contains information about an unused access analyzer.
      struct UnusedAccessConfiguration
        include JSON::Serializable

        @[JSON::Field(key: "analysisRule")]
        getter analysis_rule : Types::AnalysisRule?

        # The specified access age in days for which to generate findings for unused access. For example, if
        # you specify 90 days, the analyzer will generate findings for IAM entities within the accounts of the
        # selected organization for any access that hasn't been used in 90 or more days since the analyzer's
        # last scan. You can choose a value between 1 and 365 days.
        @[JSON::Field(key: "unusedAccessAge")]
        getter unused_access_age : Int32?

        def initialize(
          @analysis_rule : Types::AnalysisRule? = nil,
          @unused_access_age : Int32? = nil
        )
        end
      end

      # Provides aggregate statistics about the findings for the specified unused access analyzer.
      struct UnusedAccessFindingsStatistics
        include JSON::Serializable

        # A list of one to ten Amazon Web Services accounts that have the most active findings for the unused
        # access analyzer.
        @[JSON::Field(key: "topAccounts")]
        getter top_accounts : Array(Types::FindingAggregationAccountDetails)?

        # The total number of active findings for the unused access analyzer.
        @[JSON::Field(key: "totalActiveFindings")]
        getter total_active_findings : Int32?

        # The total number of archived findings for the unused access analyzer.
        @[JSON::Field(key: "totalArchivedFindings")]
        getter total_archived_findings : Int32?

        # The total number of resolved findings for the unused access analyzer.
        @[JSON::Field(key: "totalResolvedFindings")]
        getter total_resolved_findings : Int32?

        # A list of details about the total number of findings for each type of unused access for the
        # analyzer.
        @[JSON::Field(key: "unusedAccessTypeStatistics")]
        getter unused_access_type_statistics : Array(Types::UnusedAccessTypeStatistics)?

        def initialize(
          @top_accounts : Array(Types::FindingAggregationAccountDetails)? = nil,
          @total_active_findings : Int32? = nil,
          @total_archived_findings : Int32? = nil,
          @total_resolved_findings : Int32? = nil,
          @unused_access_type_statistics : Array(Types::UnusedAccessTypeStatistics)? = nil
        )
        end
      end

      # Contains information about the total number of findings for a type of unused access.
      struct UnusedAccessTypeStatistics
        include JSON::Serializable

        # The total number of findings for the specified unused access type.
        @[JSON::Field(key: "total")]
        getter total : Int32?

        # The type of unused access.
        @[JSON::Field(key: "unusedAccessType")]
        getter unused_access_type : String?

        def initialize(
          @total : Int32? = nil,
          @unused_access_type : String? = nil
        )
        end
      end

      # Contains information about an unused access finding for an action. IAM Access Analyzer charges for
      # unused access analysis based on the number of IAM roles and users analyzed per month. For more
      # details on pricing, see IAM Access Analyzer pricing .
      struct UnusedAction
        include JSON::Serializable

        # The action for which the unused access finding was generated.
        @[JSON::Field(key: "action")]
        getter action : String

        # The time at which the action was last accessed.
        @[JSON::Field(key: "lastAccessed")]
        getter last_accessed : Time?

        def initialize(
          @action : String,
          @last_accessed : Time? = nil
        )
        end
      end

      # Contains information about an unused access finding for an IAM role. IAM Access Analyzer charges for
      # unused access analysis based on the number of IAM roles and users analyzed per month. For more
      # details on pricing, see IAM Access Analyzer pricing .
      struct UnusedIamRoleDetails
        include JSON::Serializable

        # The time at which the role was last accessed.
        @[JSON::Field(key: "lastAccessed")]
        getter last_accessed : Time?

        def initialize(
          @last_accessed : Time? = nil
        )
        end
      end

      # Contains information about an unused access finding for an IAM user access key. IAM Access Analyzer
      # charges for unused access analysis based on the number of IAM roles and users analyzed per month.
      # For more details on pricing, see IAM Access Analyzer pricing .
      struct UnusedIamUserAccessKeyDetails
        include JSON::Serializable

        # The ID of the access key for which the unused access finding was generated.
        @[JSON::Field(key: "accessKeyId")]
        getter access_key_id : String

        # The time at which the access key was last accessed.
        @[JSON::Field(key: "lastAccessed")]
        getter last_accessed : Time?

        def initialize(
          @access_key_id : String,
          @last_accessed : Time? = nil
        )
        end
      end

      # Contains information about an unused access finding for an IAM user password. IAM Access Analyzer
      # charges for unused access analysis based on the number of IAM roles and users analyzed per month.
      # For more details on pricing, see IAM Access Analyzer pricing .
      struct UnusedIamUserPasswordDetails
        include JSON::Serializable

        # The time at which the password was last accessed.
        @[JSON::Field(key: "lastAccessed")]
        getter last_accessed : Time?

        def initialize(
          @last_accessed : Time? = nil
        )
        end
      end

      # Contains information about an unused access finding for a permission. IAM Access Analyzer charges
      # for unused access analysis based on the number of IAM roles and users analyzed per month. For more
      # details on pricing, see IAM Access Analyzer pricing .
      struct UnusedPermissionDetails
        include JSON::Serializable

        # The namespace of the Amazon Web Services service that contains the unused actions.
        @[JSON::Field(key: "serviceNamespace")]
        getter service_namespace : String

        # A list of unused actions for which the unused access finding was generated.
        @[JSON::Field(key: "actions")]
        getter actions : Array(Types::UnusedAction)?

        # The time at which the permission was last accessed.
        @[JSON::Field(key: "lastAccessed")]
        getter last_accessed : Time?

        def initialize(
          @service_namespace : String,
          @actions : Array(Types::UnusedAction)? = nil,
          @last_accessed : Time? = nil
        )
        end
      end

      # Contains information about the action to take for a policy in an unused permissions finding.
      struct UnusedPermissionsRecommendedStep
        include JSON::Serializable

        # A recommendation of whether to create or detach a policy for an unused permissions finding.
        @[JSON::Field(key: "recommendedAction")]
        getter recommended_action : String

        # If the recommended action for the unused permissions finding is to detach a policy, the ID of an
        # existing policy to be detached.
        @[JSON::Field(key: "existingPolicyId")]
        getter existing_policy_id : String?

        # The time at which the existing policy for the unused permissions finding was last updated.
        @[JSON::Field(key: "policyUpdatedAt")]
        getter policy_updated_at : Time?

        # If the recommended action for the unused permissions finding is to replace the existing policy, the
        # contents of the recommended policy to replace the policy specified in the existingPolicyId field.
        @[JSON::Field(key: "recommendedPolicy")]
        getter recommended_policy : String?

        def initialize(
          @recommended_action : String,
          @existing_policy_id : String? = nil,
          @policy_updated_at : Time? = nil,
          @recommended_policy : String? = nil
        )
        end
      end

      struct UpdateAnalyzerRequest
        include JSON::Serializable

        # The name of the analyzer to modify.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        @[JSON::Field(key: "configuration")]
        getter configuration : Types::AnalyzerConfiguration?

        def initialize(
          @analyzer_name : String,
          @configuration : Types::AnalyzerConfiguration? = nil
        )
        end
      end

      struct UpdateAnalyzerResponse
        include JSON::Serializable

        @[JSON::Field(key: "configuration")]
        getter configuration : Types::AnalyzerConfiguration?

        def initialize(
          @configuration : Types::AnalyzerConfiguration? = nil
        )
        end
      end

      # Updates the specified archive rule.
      struct UpdateArchiveRuleRequest
        include JSON::Serializable

        # The name of the analyzer to update the archive rules for.
        @[JSON::Field(key: "analyzerName")]
        getter analyzer_name : String

        # A filter to match for the rules to update. Only rules that match the filter are updated.
        @[JSON::Field(key: "filter")]
        getter filter : Hash(String, Types::Criterion)

        # The name of the rule to update.
        @[JSON::Field(key: "ruleName")]
        getter rule_name : String

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        def initialize(
          @analyzer_name : String,
          @filter : Hash(String, Types::Criterion),
          @rule_name : String,
          @client_token : String? = nil
        )
        end
      end

      # Updates findings with the new values provided in the request.
      struct UpdateFindingsRequest
        include JSON::Serializable

        # The ARN of the analyzer that generated the findings to update.
        @[JSON::Field(key: "analyzerArn")]
        getter analyzer_arn : String

        # The state represents the action to take to update the finding Status. Use ARCHIVE to change an
        # Active finding to an Archived finding. Use ACTIVE to change an Archived finding to an Active
        # finding.
        @[JSON::Field(key: "status")]
        getter status : String

        # A client token.
        @[JSON::Field(key: "clientToken")]
        getter client_token : String?

        # The IDs of the findings to update.
        @[JSON::Field(key: "ids")]
        getter ids : Array(String)?

        # The ARN of the resource identified in the finding.
        @[JSON::Field(key: "resourceArn")]
        getter resource_arn : String?

        def initialize(
          @analyzer_arn : String,
          @status : String,
          @client_token : String? = nil,
          @ids : Array(String)? = nil,
          @resource_arn : String? = nil
        )
        end
      end

      # A finding in a policy. Each finding is an actionable recommendation that can be used to improve the
      # policy.
      struct ValidatePolicyFinding
        include JSON::Serializable

        # A localized message that explains the finding and provides guidance on how to address it.
        @[JSON::Field(key: "findingDetails")]
        getter finding_details : String

        # The impact of the finding. Security warnings report when the policy allows access that we consider
        # overly permissive. Errors report when a part of the policy is not functional. Warnings report
        # non-security issues when a policy does not conform to policy writing best practices. Suggestions
        # recommend stylistic improvements in the policy that do not impact access.
        @[JSON::Field(key: "findingType")]
        getter finding_type : String

        # The issue code provides an identifier of the issue associated with this finding.
        @[JSON::Field(key: "issueCode")]
        getter issue_code : String

        # A link to additional documentation about the type of finding.
        @[JSON::Field(key: "learnMoreLink")]
        getter learn_more_link : String

        # The list of locations in the policy document that are related to the finding. The issue code
        # provides a summary of an issue identified by the finding.
        @[JSON::Field(key: "locations")]
        getter locations : Array(Types::Location)

        def initialize(
          @finding_details : String,
          @finding_type : String,
          @issue_code : String,
          @learn_more_link : String,
          @locations : Array(Types::Location)
        )
        end
      end

      struct ValidatePolicyRequest
        include JSON::Serializable

        # The JSON policy document to use as the content for the policy.
        @[JSON::Field(key: "policyDocument")]
        getter policy_document : String

        # The type of policy to validate. Identity policies grant permissions to IAM principals. Identity
        # policies include managed and inline policies for IAM roles, users, and groups. Resource policies
        # grant permissions on Amazon Web Services resources. Resource policies include trust policies for IAM
        # roles and bucket policies for Amazon S3 buckets. You can provide a generic input such as identity
        # policy or resource policy or a specific input such as managed policy or Amazon S3 bucket policy.
        # Service control policies (SCPs) are a type of organization policy attached to an Amazon Web Services
        # organization, organizational unit (OU), or an account.
        @[JSON::Field(key: "policyType")]
        getter policy_type : String

        # The locale to use for localizing the findings.
        @[JSON::Field(key: "locale")]
        getter locale : String?

        # The maximum number of results to return in the response.
        @[JSON::Field(key: "maxResults")]
        getter max_results : Int32?

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        # The type of resource to attach to your resource policy. Specify a value for the policy validation
        # resource type only if the policy type is RESOURCE_POLICY . For example, to validate a resource
        # policy to attach to an Amazon S3 bucket, you can choose AWS::S3::Bucket for the policy validation
        # resource type. For resource types not supported as valid values, IAM Access Analyzer runs policy
        # checks that apply to all resource policies. For example, to validate a resource policy to attach to
        # a KMS key, do not specify a value for the policy validation resource type and IAM Access Analyzer
        # will run policy checks that apply to all resource policies.
        @[JSON::Field(key: "validatePolicyResourceType")]
        getter validate_policy_resource_type : String?

        def initialize(
          @policy_document : String,
          @policy_type : String,
          @locale : String? = nil,
          @max_results : Int32? = nil,
          @next_token : String? = nil,
          @validate_policy_resource_type : String? = nil
        )
        end
      end

      struct ValidatePolicyResponse
        include JSON::Serializable

        # The list of findings in a policy returned by IAM Access Analyzer based on its suite of policy
        # checks.
        @[JSON::Field(key: "findings")]
        getter findings : Array(Types::ValidatePolicyFinding)

        # A token used for pagination of results returned.
        @[JSON::Field(key: "nextToken")]
        getter next_token : String?

        def initialize(
          @findings : Array(Types::ValidatePolicyFinding),
          @next_token : String? = nil
        )
        end
      end

      # Validation exception error.
      struct ValidationException
        include JSON::Serializable

        @[JSON::Field(key: "message")]
        getter message : String

        # The reason for the exception.
        @[JSON::Field(key: "reason")]
        getter reason : String

        # A list of fields that didn't validate.
        @[JSON::Field(key: "fieldList")]
        getter field_list : Array(Types::ValidationExceptionField)?

        def initialize(
          @message : String,
          @reason : String,
          @field_list : Array(Types::ValidationExceptionField)? = nil
        )
        end
      end

      # Contains information about a validation exception.
      struct ValidationExceptionField
        include JSON::Serializable

        # A message about the validation exception.
        @[JSON::Field(key: "message")]
        getter message : String

        # The name of the validation exception.
        @[JSON::Field(key: "name")]
        getter name : String

        def initialize(
          @message : String,
          @name : String
        )
        end
      end

      # The proposed virtual private cloud (VPC) configuration for the Amazon S3 access point. VPC
      # configuration does not apply to multi-region access points. For more information, see
      # VpcConfiguration .
      struct VpcConfiguration
        include JSON::Serializable

        # If this field is specified, this access point will only allow connections from the specified VPC ID.
        @[JSON::Field(key: "vpcId")]
        getter vpc_id : String

        def initialize(
          @vpc_id : String
        )
        end
      end
    end
  end
end
